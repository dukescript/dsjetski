/**
 * Copyright (c) 2014, 2015, Oracle and/or its affiliates.
 * All rights reserved.
 */
"use strict";
define(["ojs/ojcore","jquery","knockout","ojs/ojknockout","ojs/ojmessaging"],function(a,f,d){a.Eb=function(){this.Init()};o_("InvalidComponentTracker",a.Eb,a);a.b.ga(a.Eb,a.b,"oj.InvalidComponentTracker");a.Eb.wk="messagesShown";a.Eb.cm="messagesHidden";a.Eb.bm="disabled";a.Eb.nt="readOnly";a.Eb.prototype.Init=function(){a.Eb.q.Init.call(this);this.Rr=[];this.Bm=[];this.mr=[];this.invalidHidden=this.invalidShown=!1};a.Eb.prototype.cY=function(){var a=null,c=this,d=this.UA;this.invalidShown&&(a=this.OF());
setTimeout(function(){(a=d===c.UA?a||c.OF():c.OF())&&a.call(a,"Focus")},1);return a?!0:!1};a.b.i("InvalidComponentTracker.prototype.focusOnFirstInvalid",{cY:a.Eb.prototype.cY});a.Eb.prototype.showMessages=function(){var a,c,d;if(this.invalidHidden)for(c=this.mr.length,d=0;d<c;d++)this.mr[d]&&(a=this.Rr[d].call(a,"showMessages"))};a.b.i("InvalidComponentTracker.prototype.showMessages",{showMessages:a.Eb.prototype.showMessages});a.Eb.prototype.OF=function(){for(var a,c=0,d=this.Bm.length,c=0;c<d;c++)if(a=
this.Bm[c])return this.Rr[c];return null};a.Eb.prototype.WH=function(a){var c=-1,d=!1;f.each(this.Rr,function(d,e){0>c&&e===a&&(c=d)});0<=c&&(this.Rr.splice(c,1),this.Bm.splice(c,1),this.mr.splice(c,1),this.cJ(),d=!0);return d};a.Eb.prototype.Qj=function(b,c,d){var g=b.call(b,"isValid"),h=-1,k=!0,l;f.each(this.Rr,function(a,c){0>h&&c===b&&(h=a)});switch(c){case a.Eb.wk:case a.Eb.cm:l=!1;d&&(0>h&&(h=this.Rr.push(b)-1,this.T$(h,l)),!g&&a.Eb.RG(d)&&(l=!0,c===a.Eb.wk&&(d=b.call(b,"option",a.Eb.bm),g=
b.call(b,"option",a.Eb.nt),l=d||g?!1:!0)),k=this.Qv(c,h||0,l),this.cJ(),k&&(void 0===this.UA&&(this.UA=0),this.UA++));break;case a.Eb.bm:case a.Eb.nt:k=!1,d&&(k=this.Qv(a.Eb.wk,h||0,!1),k=this.Qv(a.Eb.cm,h||0,!1)||k,this.cJ())}return k};a.Eb.prototype.T$=function(b,c){void 0===this.Bm[b]&&this.Qv(a.Eb.wk,b,c);void 0===this.mr[b]&&this.Qv(a.Eb.cm,b,c)};a.Eb.prototype.cJ=function(){this.invalidShown=0<=this.Bm.indexOf(!0);this.invalidHidden=0<=this.mr.indexOf(!0)};a.Eb.prototype.Qv=function(b,c,d){var g=
!1;b=b===a.Eb.wk?this.Bm:b===a.Eb.cm?this.mr:[];0<=c&&void 0!==b[c]?(g=b[c]!==d?!0:!1)&&b.splice(c,1,d):(b.push(d),g=!0);return g};a.Eb.RG=function(b){return!a.Y.isValid(b)};a.vb=function(){};a.vb.et="invalidComponentTracker";a.vb.VM="ojoptionchange";a.vb.wk="messagesShown";a.vb.cm="messagesHidden";a.vb.bm="disabled";a.vb.nt="readOnly";a.vb.Qj=function(b,c,e,g,f){e={};f=f.call()[a.vb.et];var k;if(b===a.vb.bm||b===a.vb.nt)return k=f&&f.peek()||null,null!==k&&d.isWriteableObservable(f)&&k.Qj.call(k,
g,b,c)&&f.valueHasMutated(),e[b]=c,e};a.vb._init=function(a,c){var d={};d[a]=c;return d};a.vb.c4=function(b,c,d,g){g=g.call();var f;b===a.vb.et&&(f=g[b]?!0:!1)&&a.vb.mca(b,g,c,d);return{}};a.vb.y4=function(b,c,e,g){c=f(c);g=g.call()[b];b===a.vb.et&&c&&(c.off(a.vb.VM,a.vb.cX),g&&d.isWriteableObservable(g)&&(b=g.peek(),b.WH.call(b,e)&&g.valueHasMutated()))};a.vb.cX=function(b,c){var e=b.data.nL,g,f=b.data.Aa,k=c.option,l=c.value;(k===a.vb.wk||k===a.vb.cm)&&e&&d.isWriteableObservable(e)&&(g=e.peek())&&
g.Qj.call(g,f,k,l)&&e.valueHasMutated()};a.vb.mca=function(b,c,e,g){b=c[b];var h,k;e=f(e);if(d.isObservable(b))k=b.peek(),null==k&&(k=new a.Eb,b(k));else throw Error("Binding attribute "+a.vb.et+" should be bound to a ko observable.");null!==k&&(d.isWriteableObservable(b)&&(c=g.call(g,"option",a.vb.wk),h=g.call(g,"option",a.vb.cm),k.Qj.call(k,g,a.vb.wk,c),k.Qj.call(k,g,a.vb.cm,h),b.valueHasMutated()),g={nL:b,Aa:g},e.on(a.vb.VM,g,a.vb.cX))};a.ia.Xj().fk({"for":"editableValue",attributes:[a.vb.et,a.vb.bm,
a.vb.nt],init:a.vb._init,update:a.vb.Qj,afterCreate:a.vb.c4,beforeDestroy:a.vb.y4})});