/**
 * Copyright (c) 2014, Oracle and/or its affiliates.
 * All rights reserved.
 */
"use strict";
define(['./DvtToolkit'], function(dvt) {
  // Internal use only.  All APIs and functionality are subject to change at any time.
    // Map the D namespace to dvt, which is used to provide access across partitions.
  var D = dvt;
  D.qS=function(a,b,c){this.Init(a,b,c)};(0,D.ca)("DvtTagCloud",D.qS);D.z.q(D.qS,D.Oj,"DvtTagCloud");D.qS.newInstance=function(a,b,c){return new D.qS(a,b,c)};D.qS.prototype.Init=function(a,b,c){D.qS.u.Init.call(this,a,b,c);this.j().Lc.Aa().setAttributeNS(D.o,"text-rendering","geometricPrecision");this.Ta=new D.rS(this,a,this.Rd,this);this.Ta.We(this);(0,D.Mf)()||(0,D.ql)(this.Ta,new D.sS(this.Ta));this.Of=new D.tS;this.kb=[];this.nn=[];this.xg=D.o;this.Cd=new D.Nu(this.j());(0,D.Br)(this.Ta,this.Cd)};
D.qS.prototype.U=function(a,b,c){!(0,window.isNaN)(b)&&!(0,window.isNaN)(c)&&(this.Za=b,this.ob=c);this.YN();this.Ud(a);this.jb&&this.jb.stop();this.sj=this.ga;this.jDa=this.kb;this.kb=[];this.mla=[];this.ga=new D.D(this.j());this.k(this.ga);D.uS.U(this,this.ga,new D.B(0,0,this.Za,this.ob));b=this.J.animationDuration;c=new D.B(0,0,this.Za,this.ob);this.sj?"none"!==this.J.animationOnDataChange&&a&&(this.yf=new D.D(this.j()),this.k(this.yf),a=new D.Gn(this.j(),this.yf),(0,D.Hn)(a,this.jDa,this.kb),
this.jb=a.Ur()):"none"!==this.J.animationOnDisplay&&(this.jb=D.wl.jD(this.j(),D.wl.py,this.ga,c,b));this.jb?(this.Ta.Mc(),this.Ta.zk(this),this.jb.le(this.Hfa,this),this.jb.play()):this.Hfa();this.Ro()};D.qS.prototype.render=D.qS.prototype.U;D.qS.prototype.dg=function(){this.Ck||(this.Ck=new D.vS(this));return this.Ck};D.qS.prototype.getAutomation=D.qS.prototype.dg;D.qS.prototype.iy=function(a,b){this.nn.push(a);this.mla[b]=a};D.qS.prototype.Zk=(0,D.x)("nn");D.qS.prototype.vn=(0,D.x)("mla");
D.qS.prototype.Fe=function(a){this.J.highlightedCategories=D.Jl.ea(a);(0,D.Kl)(a,this.Zk(),"any"===this.J.highlightMatch);this.xg&&this.xg.Fe(a)};D.qS.prototype.highlight=D.qS.prototype.Fe;D.qS.prototype.select=function(a){this.J.selection=D.Jl.ea(a);this.Po&&(0,D.om)(this.Po,this.J.selection,this.Zk())};D.qS.prototype.select=D.qS.prototype.select;D.y=D.qS.prototype;
D.y.Ud=function(a){a?this.J=this.Of.wj(a):this.J||(this.J=(0,D.Tj)(this));a=this.J.selectionMode;this.Po="single"===a?new D.sl("s"):"multiple"===a?new D.sl("m"):D.o;this.Ta.ju(this.Po);(0,D.rl)()||(this.J.animationOnDisplay="none",this.J.animationOnDataChange="none")};D.y.Yj=function(){return(0,D.Gk)(this.A(),"componentName","DvtUtilBundle","TAG_CLOUD")};
D.y.Hfa=function(){this.sj&&(this.removeChild(this.sj),this.sj.Y(),this.sj=D.o);this.yf&&(this.removeChild(this.yf),this.yf.Y(),this.yf=D.o);this.jb&&(this.jb=D.o,this.Ta.We(this));this.Po&&(0,D.om)(this.Po,this.J.selection,this.Zk());this.J.highlightedCategories&&0<this.J.highlightedCategories.length&&this.Fe(this.J.highlightedCategories)};D.y.YN=function(){this.Ta.Mc();this.nn.length=0};D.y.za=(0,D.x)("Ta");
D.y.Rd=function(a,b){var c=a.Xa();if(c==D.cm.zw||c==D.cm.Ey){var d=a.Jk,e=this.J.hiddenCategories.indexOf(d);c==D.cm.zw&&0>e&&this.J.hiddenCategories.push(d);c==D.cm.Ey&&0<=e&&this.J.hiddenCategories.splice(e,1);this.U(this.J,this.Za,this.ob)}else if("categoryRollOver"==c||"categoryRollOut"==c)this!=b?this.Fe(a.categories):this.xg&&this.xg!=b&&this.xg.Rd(a,b);a&&this.Wa(a)};D.y.St=function(){for(var a=[],b=this.Po.getSelection(),c=0;c<b.length;c++)a=a.concat(b[c].Nd());return a};
D.qS.prototype.Ej=function(a,b,c){return this.Cd.Ej(c)};D.qS.prototype.isDragAvailable=D.qS.prototype.Ej;D.qS.prototype.tk=function(a,b){return this.Cd.tk(a,b)};D.qS.prototype.getDragTransferable=D.qS.prototype.tk;D.qS.prototype.Tt=function(a,b){return this.Cd.Tt(a,b)};D.qS.prototype.getDragOverFeedback=D.qS.prototype.Tt;D.qS.prototype.po=function(a,b){return this.Cd.po(a,b)};D.qS.prototype.getDragContext=D.qS.prototype.po;D.qS.prototype.Gv=function(a,b){return this.Cd.Gv(a,b)};
D.qS.prototype.getDragOffset=D.qS.prototype.Gv;D.qS.prototype.Nv=function(a,b){return this.Cd.Nv(a,b)};D.qS.prototype.getPointerOffset=D.qS.prototype.Nv;D.qS.prototype.Sv=function(){this.Cd.Sv()};D.qS.prototype.initiateDrag=D.qS.prototype.Sv;D.qS.prototype.Sr=function(){this.Cd.Sr()};D.qS.prototype.dragDropEnd=D.qS.prototype.Sr;
D.qS.prototype.lo=function(a,b,c){this.ul||(this.ul=new D.yS);return this.ul.lo(a,b,c)};D.qS.prototype.acceptDrag=D.qS.prototype.lo;
D.vS=(0,D.v)("Hx");(0,D.ca)("DvtTagCloudAutomation",D.vS);D.z.q(D.vS,D.Wj,"DvtTagCloudAutomation");D.vS.prototype.Xl=function(a){return(a=(0,D.Xj)(this.Hx.Ta,a))&&a instanceof D.wS?"item["+this.Hx.vn().indexOf(a)+"]":D.o};D.vS.prototype.fg=function(a){if("tooltip"==a)return(0,D.Fm)(this.Hx);var b=a.indexOf("[");return 0<b&&"item"===a.substring(0,b)&&(a=(0,window.parseInt)(a.substring(b+1,a.length-1)),a=this.Hx.vn()[a])?a.Nd()[0].Aa():D.o};D.vS.prototype.getDomElementForSubId=D.vS.prototype.fg;
D.vS.prototype.getItem=function(a){if(a=this.Hx.vn()[a]){var b={};b.color=a.Yi();b.tooltip=a.ed();b.label=a.Zc();b.value=a.getValue();b.selected=a.Fa();return b}return D.o};D.vS.prototype.getItem=D.vS.prototype.getItem;D.vS.prototype.TZ=function(){return this.Hx.Zk().length};D.vS.prototype.getItemCount=D.vS.prototype.TZ;
D.AS=function(a,b,c,d,e,f,g){this.Init(a,b,c,d,e,f,g)};D.z.q(D.AS,D.zk,"DvtTagCloudItem");D.y=D.AS.prototype;D.y.Init=function(a,b,c,d,e,f,g){D.AS.u.Init.call(this,b,c,d,e,f,g);this.Hx=a;f&&(0,D.BS)(this,f)};D.y.V0=function(a,b){this.fZ();return D.AS.u.V0.call(this,a,b)};D.y.rb=function(a){this.Qh!=a&&((this.Qh=a)?this.yl?this.Na(this.MW):this.Na(this.qY):this.Na(this.hG))};D.y.Sb=function(){this.yl||(this.yl=D.k,this.Qh?this.Na(this.MW):this.Na(this.E6))};
D.y.Ib=function(){this.Qh?this.Na(this.qY):this.Na(this.hG);this.yl=D.p};
D.y.Cf=function(a,b){var c=new D.jo(this.j(),this,D.CS.Ma(this.Hx)),d=this.oc(),e=b.oc(),f=D.p,g=e.C("color"),h=d.C("color");if(g!=h){var j=this;this.Na(d.ca("color",g));(0,D.T)(c.O,"typeColor",this,function(){return j.oc().C("color")},function(a){j.Na(j.oc().ca("color",a))},h)}e=(0,window.parseFloat)(e.C("font-size"));d=(0,window.parseFloat)(d.C("font-size"));e!=d&&(f=D.k,j=this,this.He(e),(0,D.T)(c.O,"typeNumber",this,function(){return(0,window.parseFloat)(j.oc().C("font-size"))},this.He,d));g=
b.pa();d=this.pa();e=b.so();h=this.so();if(d!=g||f&&h!=e)h!=e&&(f=g,g=b.Kf.G(D.i),g="left"==e?f+g.e:"right"==e?f-g.e:f),this.ha(g),(0,D.T)(c.O,"typeNumber",this,this.pa,this.ha,d);f=b.qa();d=this.qa();d!=f&&(this.ya(f),(0,D.T)(c.O,"typeNumber",this,this.qa,this.ya,d));b.D(0);a.add(c,1)};D.y.bi=function(a){a.add(new D.lo(this.j(),this,D.CS.Ma(this.Hx)),0)};D.y.Vg=function(a){this.D(0);a.add(new D.Jn(this.j(),this,D.CS.Ma(this.Hx)),2)};D.y.He=function(a){D.AS.u.He.call(this,a);(0,D.BS)(this,this.oc())};
D.BS=function(a,b){a.hG=b;var c=a.hG.C("color");a.hG.ca("background-color",D.o);a.E6=a.hG.ea();var d=(0,D.DS)(c,0.3);a.E6.ca("background-color",d);a.E6.ca("color",D.K.zj(d));a.qY=a.hG.ea();a.qY.ca("background-color",c);a.qY.ca("color",D.K.zj(c));a.MW=a.hG.ea();c=(0,D.DS)(c,0.6);a.MW.ca("background-color",c);a.MW.ca("color",D.K.zj(c))};
D.DS=function(a,b){var c=D.K.we(a),d=D.K.ue(a),e=D.K.qe(a);return D.K.MA(window.Math.floor(255*(1-b)+b*c),window.Math.floor(255*(1-b)+b*d),window.Math.floor(255*(1-b)+b*e))};
D.wS=function(a,b,c){this.Init(a,b,c)};D.z.q(D.wS,D.z,"DvtTagCloudObjPeer");D.y=D.wS.prototype;D.y.Init=function(a,b,c){this.K=a;this.qh=b;this.wa=c;this.$E=this.Qh=D.p;c.url?(b.ld("link"),this.w7=D.C.mD("_blank",c.url)):b.ld("img");this.yq()};D.y.getId=function(){return this.wa.id};D.y.Zc=function(){return this.wa.label};D.y.getValue=function(){return this.wa.value};D.y.ed=function(){return this.wa.shortDesc};D.y.Xe=function(){return this.wa.action};
D.y.Ne=function(){var a=this.K.A().tooltip;return a?(0,D.$p)(this.K.j().jd(),a,this.Fv()):this.ed()};D.y.Fv=function(){return{id:this.getId(),label:this.Zc(),color:this.Yi(),value:this.getValue()}};D.y.mD=(0,D.x)("w7");D.y.Yi=function(){this.Wn||(this.Wn=(new D.I(this.wa.style)).C("color"));return this.Wn};D.y.Xf=(0,D.v)("$E");D.y.Oa=(0,D.x)("$E");D.y.Fa=(0,D.x)("Qh");D.y.rb=function(a){this.Qh=a;this.qh.rb(a);this.yq()};D.y.Sb=function(){this.qh.Sb()};D.y.Ib=function(){this.qh.Ib()};
D.y.Yd=function(a){var b=this.K.Ta.yg;a.type==D.vn||b.cu(a)?a=this:b.Xg(a)?(b=this.K.Zk(),a=b.indexOf(this)+(39==a.keyCode||40==a.keyCode?1:-1),a=a<b.length&&0<=a?b[a]:D.o):a=D.o;return a};D.y.Ye=function(a){return this.qh.G(a)};D.y.Vj=function(){return this.qh.Aa()};D.y.Be=function(){this.Ub=D.k;this.Sb()};D.y.qc=function(){this.Ub&&(this.Ub=D.p,this.Ib())};D.y.Ic=(0,D.x)("Ub");D.y.Nd=function(){return[this.qh]};
D.y.nc=function(){var a=[];this.Oa()&&a.push((0,D.O)("DvtUtilBundle",this.Fa()?"STATE_SELECTED":"STATE_UNSELECTED"));return(0,D.Hk)(this.ed(),a)};D.y.Vc=function(){return this.wa.categories};D.y.yq=function(){(0,D.df)()||this.qh.Mb("label",this.nc())};D.y.Hd=function(){if(!this.xd&&(this.xd=[],this.wa.showPopupBehaviors))for(var a=this.wa.showPopupBehaviors,b=0;b<a.length;b++)this.xd.push(new D.Vi(a[b].popupId,a[b].triggerType,a[b].alignId,a[b].align));return this.xd};
D.y.Ej=function(a){return this.K.Po?a[0]:D.o};D.y.tk=function(){var a=this.K;this.Fa()||(a.Po.Cm(this,D.p),a.Ta.Dv());for(var b=[],a=a.Po.getSelection(),c=0;c<a.length;c++){var d=a[c];d instanceof D.wS&&b.push(d.getId())}return b};D.y.St=function(){return this.K.St()};
D.tS=function(){this.Init({alta:D.xS})};D.z.q(D.tS,D.fk,"DvtTagCloudDefaults");D.xS={animationOnDisplay:"none",animationOnDataChange:"none",emptyText:D.o,hiddenCategories:[],hideAndShowBehavior:"none",highlightedCategories:[],highlightMatch:"all",hoverBehavior:"none",layout:"rectangular",selectionMode:"none",styleDefaults:{animationDuration:500,hoverBehaviorDelay:200,style:new D.I('font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; color: #333333;')}};
D.uS={};D.z.q(D.uS,D.z,"DvtTagCloudRenderer");D.uS.U=function(a,b,c){D.uS.CG(a,b,c);D.uS.RC(a,b,c);D.uS.Gw(c);var d=a.A();d.items&&0<d.items.length?(d=D.uS.AEa(a,b,c),0<d.length?(a.kb=d,(0,D.Gl)(a.Ta,a.Zk()[0])):D.uS.$na(a,b,c)):D.uS.$na(a,b,c)};D.uS.$na=function(a,b,c){var d=a.A(),e=d.emptyText;e||(e=(0,D.Gk)(d,"labelNoData","DvtUtilBundle","NO_DATA",D.o));D.af.jl(b,e,new D.B(c.x,c.y,c.e,c.g),a.Ta,d.styleDefaults.style)};D.uS.CG=function(a,b,c){a=new D.F(a.j(),c.x,c.y,c.e,c.g);(0,D.Li)(a);b.k(a)};
D.uS.AEa=function(a,b,c){for(var d=a.A(),e=[],f=d.items,g=window.Number.MAX_VALUE,h=-window.Number.MAX_VALUE,j=0;j<f.length;j++)g=window.Math.min(g,f[j].value),h=window.Math.max(h,f[j].value);g=D.ES.wIa(g,h);h=D.eg.LL(d.hiddenCategories);for(j=0;j<f.length;j++){var l=f[j];l.categories||(l.categories=[l.label]);if(!h||!D.eg.eS(h,l.categories)){var m=d.styleDefaults.style.ea();(0,D.$f)(m,l.style);m.ca("font-size",g.call(D.o,l.value).toString());var m=new D.AS(a,a.j(),l.label,0,0,m,l.id),n=new D.wS(a,
m,l);a.Ta.Da(m,n);a.iy(n,j);"none"!==d.selectionMode&&n.Xf(D.k);(n.Oa()||l.url||n.Xe())&&m.setCursor("pointer");e.push(m);b.k(m)}}0<e.length&&("cloud"===d.layout?D.ES.AGa(c,e):D.ES.hMa(c,e,(0,D.G)(a.j())));return e};
D.uS.RC=function(a,b,c){var d=a.A(),e=d.legend;if(e&&e.sections){e=D.Jl.ea(e);e.orientation="horizontal";e.halign="center";e.hoverBehavior=d.hoverBehavior;e.hideAndShowBehavior=d.hideAndShowBehavior;e.hiddenCategories=d.hiddenCategories;d=(0,D.vo)(a.j(),a.Rd,a);b.k(d);var f=d.Ap(e,c.e,c.g/3);d.U(e,f.e,f.g);(0,D.to)(c,"bottom",d,f.e,f.g,0);a.xg&&(a.xg.Y(),b.removeChild(a.xg));a.xg=d}};D.uS.Gw=function(a){a.x=window.Math.round(a.x);a.y=window.Math.round(a.y);a.e=window.Math.round(a.e);a.g=window.Math.round(a.g)};
D.ES=(0,D.t)();D.z.q(D.ES,D.z,"DvtTagCloudLayoutUtils");D.ES.wIa=function(a,b){return function(c){return 12+window.Math.ceil(12*(2*(c-a)/(b-a)))}};
D.ES.AGa=function(a,b){var c=[],d=10/180,e=10/180;a.e>a.g?d*=a.e/a.g:e*=a.g/a.e;for(var f=2*window.Math.PI/180,g=D.o,h=0,j=[],l=[],m=0;m<b.length;m++)for(var n=D.p,q=0,r=4,s=b[m],u=s.G(),h=window.Math.max(h,(0,window.parseFloat)(s.oc().C("font-size"))),A=-1;!n;){var w=q%180;j[w]===D.i&&(j[w]=window.Math.cos(q*f));l[w]===D.i&&(l[w]=window.Math.sin(q*f));var E=d*q*j[w],P=e*q*l[w],N=new D.B(E,P,u.e,u.g),n=D.k;-1!=A&&c[A].uba(N)&&(n=D.p);if(n)for(w=0;w<m;w++)if(c[w].uba(N)){A=w;n=D.p;break}n&&(g=g?(0,D.tp)(g,
N):N,A=-1,c[m]=N,s.ha(E),s.ya(-u.y+P));3600===q?r=3:5400===q?r=2:10800===q&&(r=1);q+=r}c=window.Math.max(g.e/a.e,g.g/a.g);d=g.x+g.e/2;g=g.y+g.g/2;for(w=0;w<b.length;w++)s=b[w],s.ha(a.x+s.pa()/c+(a.e/2-d/c)),s.ya(a.y+s.qa()/c+(a.g/2-g/c)),e=(0,window.parseFloat)(s.oc().C("font-size")),s.He(e/c)};
D.ES.hMa=function(a,b,c){for(var d=[],e=0,f=0,g=0,h=0;h<b.length;h++){var j=b[h],l=j.G(),e=window.Math.max(e,l.e),f=window.Math.max(f,l.g),g=window.Math.max(g,(0,window.parseFloat)(j.oc().C("font-size")));d.push(new D.Kg(l.e,l.g))}h=0;for(j=(a.e-10)/e;0.001<j-h;)e=(h+j)/2,g=D.ES.sia(d,(a.e-10)/e),g.length*(e*f+2)-2>a.g-10?j=e:h=e;e=h;g=D.ES.sia(d,(a.e-10)/e);g.push(b.length);for(h=0;h<g.length-1;h++){var l=g[h],m=g[h+1],n=0,q=0,r=D.k;if(1<m-l){for(var j=0,s=l;s<m;s++)j+=d[s].e*e,q=window.Math.max(q,
d[s].g*e);n=(a.e-10-j)/(m-l-1);h==g.length-2&&(s=0.5*q,s<n&&j+(m-l)*s<0.9*(a.e-10)&&(n=s,r=D.p))}for(var q=5+(h+1)*(f*e+2)-2,u=c?a.e-5:5,s=l;s<m;s++){var j=b[s],A=(0,window.parseFloat)(j.oc().C("font-size"));j.He(A*e);j.ya(a.y+q);r&&s==m-1&&s!=l?c?(j.$h(),j.ha(a.x+5)):(j.ai(),j.ha(a.x+a.e-5)):(j.ha(a.x+u),c?(j.ai(),u-=d[s].e*e+n):(j.$h(),u+=d[s].e*e+n))}}};D.ES.sia=function(a,b){var c=[0],d=a[0].e+2;if(1<a.length)for(var e=1;e<a.length;e++)d+a[e].e>b&&(c.push(e),d=0),d+=a[e].e+2;return c};
D.CS={};D.z.q(D.CS,D.z,"DvtTagCloudStyleUtils");D.CS.Ma=function(a){return a.A().styleDefaults.animationDuration/1E3};
D.rS=function(a,b,c,d){this.Init(b,c,d);this.K=a};D.z.q(D.rS,D.hk,"DvtTagCloudEventManager");D.rS.prototype.BI=function(a){a=(0,D.Xj)(this,a.target);(0,D.zS)(a);this.pn(a)};D.rS.prototype.xN=function(a){a=(0,D.Xj)(this,a.target);this.pn(a)};D.rS.prototype.ys=function(a){a=(0,D.Xj)(this,a.target);(0,D.zS)(a);this.pn(a)};D.zS=function(a){a instanceof D.wS&&(a=a.mD())&&a.call()};D.rS.prototype.Jh=function(a){var b=D.k,c=this.Od();13==a.keyCode?(0,D.zS)(c):b=D.rS.u.Jh.call(this,a);return b};
D.rS.prototype.Yp=function(a,b,c){var d=this.K.A();"dim"==d.hoverBehavior&&(b=b.Vc?b.Vc():[],d.highlightedCategories=c?b.slice():D.o,c=new D.kn(c?"categoryRollOver":"categoryRollOut",d.highlightedCategories),b=(0,D.Zp)(d.styleDefaults.hoverBehaviorDelay),this.uB.Rd(c,this.K.Zk(),b,"any"==d.highlightMatch),a.stopPropagation())};D.rS.prototype.pn=function(a){a&&(a.Xe&&a.Xe())&&this.$g(new D.kk("action",a.Xe(),a.getId()))};
D.sS=function(a){this.Init(a)};D.z.q(D.sS,D.on,"DvtTagCloudKeyboardHandler");D.sS.prototype.Init=function(a){D.sS.u.Init.call(this,a)};D.sS.prototype.BA=function(a){return this.Xg(a)&&!a.ctrlKey};D.sS.prototype.cu=function(a){return 32==a.keyCode&&a.ctrlKey};
D.yS=(0,D.t)();D.z.q(D.yS,D.Pu,"DvtTagCloudDropTarget");D.yS.prototype.lo=function(a,b,c){return c[0]};
  return D;
});