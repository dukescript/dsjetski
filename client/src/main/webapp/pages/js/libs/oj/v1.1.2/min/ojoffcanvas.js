/**
 * Copyright (c) 2014, 2015, Oracle and/or its affiliates.
 * All rights reserved.
 */
"use strict";
define(["ojs/ojcore","jquery","hammerjs","promise","ojs/ojjquery-hammer","ojs/ojcomponentcore"],function(a,f,d){a.U={};o_("OffcanvasUtils",a.U,a);a.U.IM="oj-offcanvasEdge";a.U.aq="oj-offcanvas";a.U.cD="oj-mediaQueryListener";a.U.JM="oj-offcanvasHammer";a.U.Mda={start:"oj-offcanvas-shift-start",end:"oj-offcanvas-shift-end",top:"oj-offcanvas-shift-down",bottom:"oj-offcanvas-shift-up"};a.U.N6={start:"oj-offcanvas-start",end:"oj-offcanvas-end",top:"oj-offcanvas-top",bottom:"oj-offcanvas-bottom"};a.U.Dm=
function(a){return a.hasClass("oj-offcanvas-open")};a.U.PR=function(a){return a.closest(".oj-offcanvas-outer-wrapper")};a.U.BF=function(a){var c=f(a.selector);return"push"===a.displayMode?c.parent():c};a.U.bS=function(b){var c=a.U.Mda[b];if(!c)throw"Invalid edge: "+b;return c};a.U.Ke=function(){return"rtl"===a.C.rs()};a.U.oI=function(a,c){a.css({"-webkit-transform":c,"-ms-transform":c,transform:c})};a.U.Cda=function(b,c,d){c="end"===c;a.U.Ke()&&(c=!c);a.U.oI(b,"translate3d("+(c?"-":"")+d+", 0, 0)")};
a.U.Dda=function(b,c,d){a.U.oI(b,"translate3d(0, "+("bottom"===c?"-":"")+d+", 0)")};a.U.CV=function(b){var c=b.edge;b=f(b.selector);c&&c.length||(c=b.hasClass("oj-offcanvas-start")?"start":b.hasClass("oj-offcanvas-end")?"end":b.hasClass("oj-offcanvas-top")?"top":b.hasClass("oj-offcanvas-bottom")?"bottom":"start");f.data(b[0],a.U.IM,c);return c};a.U.LF=function(b){return f.data(b[0],a.U.IM)};a.U.UW=function(a,c,d){var g=a.displayMode,h=f(a.selector),g="overlay"===g?"oj-offcanvas-transition oj-offcanvas-overlay":
"oj-offcanvas-transition";d?(d=h.attr("tabIndex"),void 0!==d&&(a.tabIndex=d),h.addClass("oj-offcanvas-open").attr("tabIndex","-1"),c.addClass(g)):(d=a.tabIndex,void 0===d?h.removeAttr("tabIndex"):h.attr("tabIndex",d),h.removeClass("oj-offcanvas-open"),c.removeClass(g))};a.U.caa=function(a){return"none"!=a.autoDismiss};a.U.mU=function(a,c){function d(){c();a.off("transitionend webkitTransitionEnd otransitionend oTransitionEnd",d)}a.on("transitionend webkitTransitionEnd otransitionend oTransitionEnd",
d)};a.U.jca=function(b){a.U.bX(b);if(a.U.caa(b)){var c=f(b.selector),d=b.dismisHandler=function(d){var e=d.target;a.C.lZ(d)||"focus"===d.type&&!f(e).is(":focusable")||a.C.Hga(c[0],e)||a.U.close(b)},g=document.documentElement;a.C.sf()&&g.addEventListener("touchstart",d,!0);g.addEventListener("mousedown",d,!0);g.addEventListener("focus",d,!0)}a.U.oA(b)};a.U.bX=function(b){var c=b.dismisHandler;if(c){var d=document.documentElement;a.C.sf()&&d.removeEventListener("touchstart",c,!0);d.removeEventListener("mousedown",
c,!0);d.removeEventListener("focus",c,!0);delete b.dismisHandler;b.dismisHandler=null}a.U.SA(b)};a.U.oA=function(b){if(a.C.sf()){var c=b.selector,e=f(c),g=a.U.LF(e),h,k;"start"==g&&!a.U.Ke()||"end"==g&&a.U.Ke()?(k={recognizers:[[d.Swipe,{direction:d.DIRECTION_LEFT}]]},h="swipeleft"):"start"==g&&a.U.Ke()||"end"==g&&!a.U.Ke()?(k={recognizers:[[d.Swipe,{direction:d.DIRECTION_RIGHT}]]},h="swiperight"):"top"==g?(k={recognizers:[[d.Swipe,{direction:d.DIRECTION_UP}]]},h="swipeup"):"bottom"==g&&(k={recognizers:[[d.Swipe,
{direction:d.DIRECTION_DOWN}]]},h="swipedown");e=e.wn(k).on(h,function(c){c.preventDefault();a.U.close(b)});f.data(f(c)[0],a.U.JM,{event:h,hammer:e})}};a.U.SA=function(b){b=f(b.selector);(b=f.data(b[0],a.U.JM))&&b.hammer.off(b.event)};a.U.wO=function(b){var c=f(b.selector);a.U.LF(c);var d=a.U.BF(b);a.U.UW(b,d,!1);a.U.bX(b);c.trigger("ojclose",b);f.removeData(c[0],a.U.aq)};a.U.eW=function(b,c,d){var g=f(b);(c=!!c)&&a.U.Dm(g)&&a.U.Bk(b,!1);g.toggleClass(a.U.N6[d],!c)};a.U.wha=function(b){var c=b.query;
if(null!==c){var d=b.selector,c=window.matchMedia(c),g=a.U.CV(b);b=function(b){a.U.eW(d,b.matches,g)};c.addListener(b);a.U.eW(d,c.matches,g);f.data(f(d)[0],a.U.cD,{mqList:c,mqListener:b})}};o_("OffcanvasUtils.setupResponsive",a.U.wha,a);a.U.Fha=function(b){b=f(b.selector);var c=f.data(b[0],a.U.cD);c&&(c.mqList.removeListener(c.mqListener),f.removeData(b[0],a.U.cD))};o_("OffcanvasUtils.tearDownResponsive",a.U.Fha,a);a.U.open=function(b){var c=f(b.selector),d=f.data(c[0],a.U.aq);if(d){if(d._closePromise)return d._closePromise;
if(d._openPromise)return d._openPromise}var d=new Promise(function(d,e){a.j.Wa(c,jQuery);var g=a.U.CV(b),m=f.Event("ojbeforeopen");c.trigger(m,b);if(!1===m.result)e("ojbeforeopen veto");else{var n,m=b.displayMode,q=a.U.BF(b);a.j.Wa(q,jQuery);var p=f.extend({},b);f.data(c[0],a.U.aq,p);a.U.UW(p,q,!0);"start"==g||"end"==g?(n=void 0===n?c.outerWidth(!0)+"px":n,"push"==m&&a.U.Cda(q,g,n)):(n=void 0===n?c.outerHeight(!0)+"px":n,"push"==m&&a.U.Dda(q,g,n));window.setTimeout(function(){var b=a.U.PR(c);a.j.Wa(b,
jQuery);b.addClass(a.U.bS(g))},0);a.U.mU(q,function(){q.removeClass("oj-offcanvas-transition");a.fd.ew(c[0]);c.trigger("ojopen",p);a.U.jca(p);d(!0)})}}),g=f.data(c[0],a.U.aq);g&&(g._openPromise=d);return d};o_("OffcanvasUtils.open",a.U.open,a);a.U.close=function(b){return a.U.Bk(b.selector,!0)};o_("OffcanvasUtils.close",a.U.close,a);a.U.Bk=function(b,c){var d=f(b);a.j.Wa(d,jQuery);var g=f.data(d[0],a.U.aq);if(g&&g._closePromise)return g._closePromise;var h=new Promise(function(h,l){if(a.U.Dm(d)){b!=
g.selector&&h(!0);var m=a.U.LF(d),n=g.displayMode,m=a.U.bS(m),q=a.U.PR(d);a.j.Wa(q,jQuery);q.hasClass(m)||h(!0);var p=f.Event("ojbeforeclose");d.trigger(p,g);!1===p.result?l("beforeClose veto"):(p=a.U.BF(g),c&&a.U.mU(p,function(){a.U.wO(g);h(!0)}),"push"==n&&a.U.oI(p,""),q.removeClass(m),c?p.addClass("oj-offcanvas-transition"):(a.U.wO(g),h(!0)))}else h(!0)});(g=f.data(d[0],a.U.aq))&&(g._closePromise=h);return h};a.U.toggle=function(b){var c=f(b.selector);a.j.Wa(c,jQuery);return a.U.Dm(c)?a.U.close(b):
a.U.open(b)};o_("OffcanvasUtils.toggle",a.U.toggle,a)});