/**
 * Copyright (c) 2014, 2015, Oracle and/or its affiliates.
 * All rights reserved.
 */
"use strict";
define(["ojs/ojcore","jquery","promise"],function(a,f){a.$=window.oj.Events={on:function(a,b,c){return this.qk(a,b,c,!1,!1)},off:function(a,b,c){return this.wH(a,b,c,!1)},trigger:function(d){var b=Array.prototype.slice.call(arguments);b.unshift(!1);return a.$.Pb.apply(this,b)},once:function(a,b,c){return this.nU(a,b,c,!1,null)},listenTo:function(d,b,c){var e,g,h,f,l={};b.constructor===String?l[b]=c:l=b;for(f in l)if(l.hasOwnProperty(f))for(b=a.$.wo(f),c=0;c<b.length;c+=1)e=b[c].event,g=b[c].X,h={event:e,
X:g,object:d,Xb:l[f]},this.xE(this._listeningTo,h,a.$.NT),e=g?e+":"+g:e,void 0===this._listeningTo&&(this._listeningTo=[]),this._listeningTo.push(h),d.qk(e,l[f],null,!0,!1);return this},listenToOnce:function(d,b,c){var e,g,h,f,l={};b.constructor===String?l[b]=c:l=b;for(f in l)if(l.hasOwnProperty(f))for(b=a.$.wo(f),c=0;c<b.length;c+=1)e=b[c].event,g=b[c].X,h={event:e,X:g,object:d,Xb:l[f]},this.xE(this._listeningTo,h,a.$.NT),e=g?e+":"+g:e,void 0===this._listeningTo&&(this._listeningTo=[]),this._listeningTo.push(h),
d.nU(e,l[f],null,!0,this);return this},stopListening:function(d,b,c){var e,g={},h,f,l,m,n,q,p,r,s;if(null==arguments||1>=arguments.length){q=this._listeningTo?this._listeningTo.length:0;for(r=0;r<q;r++)if(m=this._listeningTo[r],n=d?d===m.object:!0)n=m.object.wH,n.apply(m.object,[m.event,m.Xb,m.context,!0]);this._listeningTo=[];return this}e=b;d&&d.constructor===String&&(e=d);e.constructor===String?g[e]=c:g=e;for(s in g)if(g.hasOwnProperty(s))for(e=a.$.wo(s),h=0;h<e.length;h+=1)for(f=e[h].event,l=
e[h].X,q=this._listeningTo?this._listeningTo.length:0,r=q-1;0<=r;r-=1)m=this._listeningTo[r],n=d?d===m.object:!0,q=f?f===m.event:!0,p=c?g[s]===m.Xb:!0,m=l?l===m.X:!0,n&&q&&p&&m&&(n=this._listeningTo[r].object.wH,n.apply(this._listeningTo[r].object,[this._listeningTo[r].event,this._listeningTo[r].Xb,this._listeningTo[r].context,!0]),this._listeningTo.splice(r,1));return this}};a.$.bind=a.$.on;a.$.unbind=a.$.off;a.$.F={ADD:"add",ALLADDED:"alladded",REMOVE:"remove",RESET:"reset",REFRESH:"refresh",SORT:"sort",
CHANGE:"change",DESTROY:"destroy",ALLREMOVED:"allremoved",REQUEST:"request",SYNC:"sync",ERROR:"error",INVALID:"invalid",READY:"ready",ALL:"all"};o_("Events.EventType",a.$.F,a);a.$.JC=function(a,b){var c,e=b||this;for(c in e)"function"===typeof e[c]&&(a[c]=e[c]);a.Oc={};a._listeningTo=[]};a.$.nU=function(a,b,c,e,g){var h,f,l,m;l=this.MF(a,b);for(m in l)if(l.hasOwnProperty(m))for(a=this.wo(m),b=0;b<a.length;b+=1)h=a[b].event,f=a[b].X,void 0===this.Oc&&(this.Oc=[]),void 0===this.Oc[h]&&(this.Oc[h]=[]),
this.Oc[h].push({Xb:l[m],context:c,X:f,zl:!0,fired:!1,pn:e,Kw:g});return this};a.$.jW=function(a){return a.zl?a.fired?!1:a.fired=!0:!0};a.$.hR=function(a,b){return b.context||b.Kw||a};a.$.Pb=function(d,b){var c=this.wo(b),e,g,h,f,l,m;f=[];for(e=0;e<c.length;e+=1)g=c[e].event,h=c[e].X,f.push({event:g,X:h});for(e=0;e<f.length;e+=1){l=this.hz(this.Oc,a.$.F.ALL);c=a.$.hz(this.Oc,f[e].event,!1);for(g=0;g<(c?c.length:0);g+=1)c[g].X===f[e].X&&c[g].Xb&&(h=Array.prototype.slice.call(arguments),c&&c[g]&&c[g].zl&&
(this.fV(a.$.hz(this.Oc,f[e].event,!0),c[g]),c[g].Kw&&c[g].Kw.stopListening(this,b,c[g].Xb)),c&&c[g]&&this.jW(c[g])&&(m=c[g].Xb,d&&!c[g].fZ||m.apply(a.$.hR(this,c[g]),h.slice(2))));for(g=0;g<(l?l.length:0);g+=1)h=Array.prototype.slice.call(arguments),0<h.length&&(h[1]=f[e].X?f[e].event+":"+f[e].X:f[e].event),l&&l[g]&&l[g].Xb&&this.jW(l[g])&&(m=l[g].Xb,d&&!l[g].fZ||m.apply(a.$.hR(this,l[g]),h.slice(1))),l&&l[g]&&l[g].zl&&(this.fV(this.hz(this.Oc,a.$.F.ALL,!0),l[g]),l[g].Kw&&l[g].Kw.stopListening(this,
a.$.F.ALL,l[g].Xb))}return this};a.$.qk=function(d,b,c,e,g){var h,f,l,m;d=this.MF(d,b);for(h in d)if(d.hasOwnProperty(h))for(b=this.wo(h),f=0;f<b.length;f+=1)l=b[f].event,m=b[f].X,void 0===this.Oc&&(this.Oc=[]),void 0===this.Oc[l]&&(this.Oc[l]=[]),m={Xb:d[h],context:c,X:m,pn:e,fZ:g},-1===this.xE(this.Oc[l],m,a.$.k$)&&this.Oc[l].push(m);return this};a.$.wH=function(a,b,c,e){var g,h;if(null==arguments||0==arguments.length)return this.Oc={},this;if(null==a)return this.eV(a,b,c,e),this;g=this.MF(a,b);
for(h in g)g.hasOwnProperty(h)&&this.eV(h,g[h],c,e);return this};a.$.MF=function(a,b){var c={};a.constructor===String?c[a]=b:c=a;return c};a.$.eV=function(d,b,c,e){var g=[],h,f,l,m,n,q,p,r;if(d)g=a.$.wo(d);else if(void 0!==this.Oc)for(f in this.Oc)this.Oc.hasOwnProperty(f)&&g.push({event:f});for(d=0;d<g.length;d+=1)if(f=g[d].event,l=g[d].X,void 0!==this.Oc&&this.Oc[f]instanceof Array){m=this.Oc[f];for(h=m.length-1;0<=h;h-=1)n=void 0===b||null===b||m[h].Xb==b,q=void 0===c||null===c||m[h].context==
c,p=void 0===l||null===l||m[h].X==l,r=void 0===e||null===e||m[h].pn==e,n&&q&&p&&r&&m.splice(h,1);0===m.length&&delete this.Oc[f]}};a.$.fV=function(a,b){var c,e,g,h,f,l;if(a)for(c=a.length-1;0<=c;c-=1)e=void 0===b.Xb||null===b.Xb||a[c].Xb==b.Xb,g=void 0===b.context||null===b.context||a[c].context==b.context,h=void 0===b.X||null===b.X||a[c].X==b.X,f=void 0===b.pn||null===b.pn||a[c].pn==b.pn,l=void 0===b.zl||null===b.zl||a[c].zl==b.zl,e&&g&&h&&f&&l&&a.splice(c,1)};a.$.wo=function(a){a=a?a.split(" "):
[];var b=[],c,e,g;for(c=0;c<a.length;c+=1)e=a[c].split(":"),g=e[0],e=1<e.length?e[1]:null,b.push({event:g,X:e});return b};a.$.k$=function(a,b){return a.Xb===b.Xb&&a.X===b.X&&a.context===b.context&&a.pn===b.pn&&a.zl===b.zl};a.$.NT=function(a,b){return a.event===b.event&&a.X===b.X&&a.context===b.context&&a.object===b.object};a.$.xE=function(a,b,c){var e;if(void 0===a)return-1;for(e=0;e<a.length;e+=1)if(c(a[e],b))return e;return-1};a.$.hz=function(a,b,c){if(a&&a[b]instanceof Array){if(c)return a[b];
c=[];var e;for(e=0;e<a[b].length;e++)c.push(a[b][e]);return c}return null};a.l=function(d,b){a.l.Vu||a.l._init(this,d,b,null)};o_("Collection",a.l,a);a.b.ga(a.l,a.b,"oj.Collection");a.l.prototype.un=null;a.b.i("Collection.prototype.model",{un:a.l.prototype.un});a.l.prototype.MZ=function(a){var b=this.model;return b&&a?a[b.idAttribute||b.prototype.idAttribute||"id"]:null};a.b.i("Collection.prototype.modelId",{MZ:a.l.prototype.MZ});a.l.prototype.length=void 0;a.b.i("Collection.prototype.length",{length:a.l.prototype.length});
a.l.prototype.OZ=void 0;a.b.i("Collection.prototype.models",{OZ:a.l.prototype.OZ});a.l.prototype.Wb=[];a.l.prototype.url=null;a.b.i("Collection.prototype.url",{url:a.l.prototype.url});a.l.prototype.bn=[];a.b.i("Collection.prototype.changes",{bn:a.l.prototype.bn});a.l.prototype.Wi=null;a.b.i("Collection.prototype.customURL",{Wi:a.l.prototype.Wi});a.l.prototype.SX=null;a.b.i("Collection.prototype.customPagingOptions",{SX:a.l.prototype.SX});a.l.prototype.uZ=void 0;a.b.i("Collection.prototype.lastFetchSize",
{uZ:a.l.prototype.uZ});a.l.prototype.aZ=!1;a.b.i("Collection.prototype.hasMore",{aZ:a.l.prototype.aZ});a.l.prototype.O_=void 0;a.b.i("Collection.prototype.totalResults",{O_:a.l.prototype.O_});a.l.prototype.tZ=void 0;a.b.i("Collection.prototype.lastFetchCount",{tZ:a.l.prototype.tZ});a.l.prototype.NZ=-1;a.b.i("Collection.prototype.modelLimit",{NZ:a.l.prototype.NZ});a.l.prototype.offset=void 0;a.b.i("Collection.prototype.offset",{offset:a.l.prototype.offset});a.l.prototype.$X=-1;a.b.i("Collection.prototype.fetchSize",
{$X:a.l.prototype.$X});a.l.prototype.fL=1;a.b.i("Collection.prototype.sortDirection",{fL:a.l.prototype.fL});a.l.prototype.vJ=null;a.b.i("Collection.prototype.comparator",{vJ:a.l.prototype.vJ});a.l.prototype.B_=!0;a.b.i("Collection.prototype.sortSupported",{B_:a.l.prototype.B_});a.l.prototype.Init=function(){a.l.q.Init.call(this)};a.l.extend=function(d,b){a.l.Vu=!0;var c=new a.l;a.l.Vu=!1;f.extend(c,this.prototype);var e;e=d&&d.constructor&&d.hasOwnProperty("constructor")?d.constructor:function(b,
c){a.l._init(this,b,c,d)};if(b)for(var g in b)b.hasOwnProperty(g)&&(e[g]=b[g]);if(d)for(g in d)d.hasOwnProperty(g)&&(c[g]=d[g]);f.extend(e,this);e.prototype=c;e.extend=a.l.extend;return e.prototype.constructor=e};o_("Collection.extend",a.l.extend,a);a.l._init=function(d,b,c,e){var g,h;d.Init();a.$.JC(d);if(e)for(g in e)e.hasOwnProperty(g)&&(d[g]=e[g]);c=c||{};h=["url","comparator","model",a.l.xd,"modelLimit","customURL"];for(g=0;g<h.length;g++)c.hasOwnProperty(h[g])&&void 0!==c[h[g]]&&(d[h[g]]=c[h[g]]);
void 0===d.Cj(null)&&d.XB(-1);void 0===d.modelLimit&&d.aL(-1);d.hasMore=!1;d.ai=0;d.ap([],!0);c.parse&&(b=d.parse(b));if(null!=b)for(c.SZ=!0,h=b instanceof Array?b:[b],g=0;g<h.length;g+=1)d.add(h[g],c);d.Nj();e&&e.initialize&&e.initialize.call(d,b,c)};a.l.prototype.on=function(){};a.l.prototype.qk=function(){};a.l.prototype.Pb=function(){};a.l.prototype.QQ=function(d,b,c,e){this.Pb(e,a.$.F.REQUEST,d,b,c)};a.l.prototype.Oca=function(){this.changes=[]};a.l.prototype.jI=function(a,b){for(var c=a;c<a+
b;c++)-1===this.changes.indexOf(c)&&(this.changes.push(c),this.changes.sort(function(a,d){return a-d}))};a.l.prototype.ap=function(a,b){this.models=a;if(b)this.Wb=[],this.Oca();else for(var c=0;c<a.length;c++)a[c]&&this.Wb.push(c)};a.l.prototype.vc=function(){return this.models};a.l.prototype.Mc=function(){return this.vc().length};a.l.prototype.tba=function(a){return a<this.Mc()||this.ab()&&(!this.Go()||0===this.Mc())?!1:!0};a.l.prototype.Go=function(){return a.l.Gk(this.totalResults)};a.l.Gk=function(a){return null!=
a};a.l.prototype.Wba=function(a){this.vc().push(a);this.Wb.push(this.Mc()-1);this.jI(this.Mc()-1,1)};a.l.prototype.Xba=function(a){this.nH(a);this.Wba(a);this.ai++;a.$s(this.Mc()-1)};a.l.prototype.LU=function(a){if(a)for(var b=0;b<a.length;b++)a[b]&&this.ai--};a.l.prototype.zW=function(a,b,c){for(var e=a;e<a+b;e++)this.lV(this.Ib(e));void 0===c?(this.LU(this.vc().splice(a,b)),this.yW(a,a+b-1)):(this.LU(this.vc().splice(a,b,c)),this.yW(a,a+b-1),this.X$(a),this.nH(c));this.jI(a,b);0>this.ai&&(this.ai=
0);this.JU(a)};a.l.prototype.Ib=function(a){return this.vc()[a]};a.l.prototype.JU=function(a){for(var b,c=0;c<this.Wb.length;c++)b=this.Wb[c],b>=a&&this.Ib(b)&&this.Ib(b).$s(b)};a.l.prototype.lV=function(a){if(a){var b=a.TK;a=a.Sga;b?b.NC(a):this.head=a;a?a.hx(b):this.tail=b}};a.l.prototype.nH=function(a){a.NC(this.head);this.head?this.head.hx(a):this.tail=a;a.hx(null);this.head=a};a.l.prototype.wda=function(a){-1===this.Wb.indexOf(a)&&this.Wb.push(a)};a.l.prototype.X$=function(a){for(var b=0;b<this.Wb.length;b++)this.Wb[b]>=
a&&this.Wb[b]++;this.Wb.push(a)};a.l.prototype.yW=function(a,b){void 0===b&&(b=a);this.mP(a,b);for(var c=b-a+1,e=0;e<this.Wb.length;e++)this.Wb[e]>b&&(this.Wb[e]-=c)};a.l.prototype.mP=function(a,b){void 0===b&&(b=a);for(var c=a;c<=b;c++){var e=this.Wb.indexOf(a);-1<e&&this.Wb.splice(e,1)}};a.l.prototype.BA=function(a,b){var c=this.Ib(a);this.lV(c);c||this.ai++;this.jI(a,1);if(this.vc()[a]=b)this.wda(a),b.$s(a),this.nH(b)};a.l.prototype.f5=function(a){var b=this.tail,c,e,g=0;for(this.tail=null;b&&
g<a;)c=b.B0(),(e=this.Ib(c))&&e.cK()?(this.tail||(this.tail=b),b=b.TK):(this.ai--,-1<c&&(this.BA(c,void 0),this.mP(c,c)),b.NC(null),b=b.hx(null),g++);this.tail||(this.tail=b);0>this.ai&&(this.ai=0);0===this.ai&&(this.tail=this.head=null)};a.l.prototype.wv=function(){this.ai=0;this.tail=this.head=null};a.l.prototype.Qo=function(a){if(this.ab()){var b=this.KR();-1<b&&this.ai+a>b&&this.f5(this.ai+a-b)}};a.l.prototype.clone=function(){return this.qP(!0)};a.b.i("Collection.prototype.clone",{clone:a.l.prototype.clone});
a.l.prototype.qP=function(a){var b=new this.constructor,c;this.ab()&&(b=this.y5(b),b.cI());b=this.z5(b);if(a){var e=[];for(a=0;a<this.Wb.length;a++)e.push(this.Wb[a]);e.sort(function(a,d){return a-d});var g;for(a=0;a<e.length;a++)g=e[a],(c=this.Ak(g,null,!0,!1))&&b.yk(c.clone(),{at:g},!0,!1)}return b};a.l.prototype.z5=function(a){var b=["comparator","model","modelId"],c,e;for(e=0;e<b.length;e++)c=b[e],a[c]=this[c];return a};a.l.prototype.y5=function(d){var b=["totalResults","hasMore",a.l.xd],c,e;
for(e=0;e<b.length;e++)c=b[e],d[c]=this[c];return d};a.l.prototype.Kd=function(){return this.length};a.l.prototype.Nj=function(){var a=this.Mc();this.length=a;this.ab()||(this.totalResults=a)};a.l.NE=function(a,b,c){return a.model?f.isFunction(a.model)?new a.model(b,c):new a.model.constructor(b,c):null};a.l.prototype.dv=function(d,b,c){var e=null;b=b||{};b.vga=c;d instanceof a.t?e=d:this.model?e=a.l.NE(this,d,b):(b.collection=this,e=new a.t(d,b));return b.validate&&e.validate&&(d=e.validate(e.attributes))?
(b.validationError=d,this.Pb(!1,a.$.F.INVALID,e,d,b),null):e};a.l.prototype.add=function(a,b){this.Qo(1);return this.Gu(this.yk(a,b,!1,(b||{}).deferred))};a.b.i("Collection.prototype.add",{add:a.l.prototype.add});a.l.prototype.yk=function(d,b,c,e){function g(d,e,g,h,p){var f,k=null;!q&&t&&g?(x=g.L0(e,d.comparator,n),k=g):(q||(f=d.GR(h))&&c&&m!==f.index&&a.u.warn("Duplicate ID fetched or added without merging, the id \x3d "+f.Bf()),void 0===f?(void 0===m?(d.Xba(h),r=d.Mc()-1,d.Ib(r).gx()):(r=m,d.ab()&&
c?d.BA(r,h):d.zW(r,0,h),d.Ib(r).gx(),m+=1),void 0===h.Ps()&&h.Zs(d),d.Nj(),d.Faa(h),u=!0,k=h):k=f);c&&(b=b||{},b.fillIn=!0);x&&void 0===f&&!v&&void 0===m&&1<d.Kd()&&(-1<r&&(s=d.Ib(r).cid),e={},a.Ac.Qf(e,b),e.add=!0,d.sort(e),-1<r&&(r=d.ab()?-1:d.indexOf(d.KJ(s),p)));u&&(b.at&&(b.index=r),h?(h.Pb(n,a.$.F.ADD,h,d,b),w.push(h)):(g.Pb(n,a.$.F.ADD,g,d,b),w.push(g)));return k}function h(d,e,h){u=!1;var p=d.dv(e,b,!1),f=null,n=null;if(null!=p){r=-1;p.pj();f=e instanceof a.t?e:p;if(h)return q?new Promise(function(a){g(d,
f,void 0,p,h);a(void 0)}):d.$g(f,{silent:!0},h,!0).then(function(a){n=a.m;a=g(d,f,n,p,h);z.push(a)});!q&&t&&(n=c?d.GR(f):d.get(f));(e=g(d,f,n,p,h))&&z.push(e)}else z.push(!1)}function f(a,d){return a.parse&&b.parse&&!b.SZ?a.parse(d):d}b=b||{};var l=[],m=b.at,n=b.silent,q=b.force,p,r,s,t=b.merge||!1,v=b.sort,x=!0,u=!1,w=[],z=[];void 0!==m&&0>m&&(m+=this.Kd()+1);d instanceof Array?l=d:l.push(d);if(!c&&(this.ab()||e)){var B=this;return new Promise(function(d,c){function e(a){return new Promise(function(d,
b){h(B,l[a],!0).then(function(){d(a+1)},b)})}var g=Promise.resolve(0);l=f(B,l);for(p=0;p<l.length;p++)g=g.then(e);g.then(function(){0<w.length&&B.Pb(b.silent,a.$.F.ALLADDED,B,w,b);d(a.l.eI(z))},c)})}l=f(this,l);for(p=0;p<l.length;p++)h(this,l[p],!1);0<w.length&&this.Pb(b.silent,a.$.F.ALLADDED,this,w,b);return a.l.eI(z)};a.l.eI=function(a){return 1===a.length?a[0]:a};a.l.prototype.yz=function(){return a.l.Gk(this.comparator)};a.l.prototype.sort=function(d){d=d||{};var b=d.silent,c=this.comparator,
e;if(!this.yz())return null;if(this.ab()){var g=this.totalResults;this.Go()?this.ap(Array(g),!0):(this.ap([],!0),this.wv(),this.Nj());g=d.add?{add:!0}:null;this.Pb(b,a.$.F.SORT,this,g,null);b=d.startIndex;return void 0!==b&&null!==b?this.Rw(b,this.Cj(d)):null}e=this;this.vc().sort(function(d,b){return a.l.lM(d,b,c,e,e)});this.JU(0);g=d.add?{add:!0}:null;this.Pb(b,a.$.F.SORT,this,g,null);return null};a.b.i("Collection.prototype.sort",{sort:a.l.prototype.sort});a.l.um=function(d,b){return d instanceof
a.t?d.get(b):a.t.Ol(d,b)};a.l.lM=function(d,b,c,e,g){var h,k,l;if(f.isFunction(c)){if(1===c.length){h=c.call(g,d);k=c.call(g,b);h=a.Ba.rd(h)?h.split(","):[h];var m=a.Ba.rd(k)?k.split(","):[k];for(l=0;l<h.length;l++)if(k=a.l.Ck(h[l],m[l],e.sortDirection),0!==k)return k}return c.call(g,d,b)}if(a.Ba.rd(c))for(c=c.split(","),l=0;l<c.length;l++)if(h=a.l.um(d,c[l]),k=a.l.um(b,c[l]),k=a.l.Ck(h,k,e.sortDirection),0!==k)return k;return 0};a.l.prototype.D_=function(d,b){var c=b?b:this.comparator,e;if(!c)return-1;
this.kf("sortedIndex");e=this;return a.l.i7(this.vc(),d,function(d,b){var k,l;if(f.isFunction(c)){if(1===c.length){k=c.call(e,d);l=c.call(e,b);k=a.Ba.rd(k)?k.split(","):[k];l=a.Ba.rd(l)?l.split(","):[l];var m,n;for(n=0;n<k.length;n++)if(m=a.l.Ck(k[n],l[n],e.sortDirection),0!==m)return m}return c.call(e,d,b)}return a.Ba.rd(c)?(k=d.get(c),l=b.get(c),a.l.Ck(k,l,e.sortDirection)):0})};a.b.i("Collection.prototype.sortedIndex",{D_:a.l.prototype.D_});a.l.i7=function(a,b,c){function e(g,h){var f,l;if(g>h)return-1;
f=b.Nn();l=b.Bf();if(a[g].Rn(l,f))return g;if(a[h].Rn(l,f))return h;f=Math.floor((h+g)/2);return-1===c(a[f],b)?e(g+1,f):1===c(a[f],b)?e(f,h-1):f}return e(0,a.length-1)};a.l.Ck=function(a,b,c){if(-1===c){if(a<b)return 1;if(b<a)return-1}else{if(a>b)return 1;if(b>a)return-1}return 0};a.l.prototype.unshift=function(d,b){var c={};a.Ac.Qf(c,b||{});c.at||(c.at=0);this.Qo(1);return this.Gu(this.yk(d,c,!1,c.deferred))};a.b.i("Collection.prototype.unshift",{unshift:a.l.prototype.unshift});a.l.prototype.Gu=
function(a){return f.isFunction(a.then)?this.qg(function(){return a}):a};a.l.prototype.shift=function(a){var b=this.df(a);if(this.ab()||b){var c=this;return this.at(0,a).then(function(b){return c.Rm(b,0,a)})}return this.Rm(this.at(0),0,a)};a.b.i("Collection.prototype.shift",{shift:a.l.prototype.shift});a.l.prototype.iZ=function(a){void 0===a&&(a=1);this.kf("initial");var b=[],c;for(c=0;c<this.Kd()-a;c+=1)b.push(this.at(c));return b};a.b.i("Collection.prototype.initial",{iZ:a.l.prototype.iZ});a.l.prototype.df=
function(a){return(a||{}).deferred};a.l.prototype.last=function(a,b){var c=this.df(b);void 0===a&&(a=1);if(1===a){var e=this.Mc();0===e&&(e=a);return 0<e?this.at(e-1,c):null}var g=[],e=this.Kd();if(c||this.ab()){var h=e-a;0>h&&(h=0);0===e&&(e=a);return this.qg(function(){return this.Qp(h,e)})}for(c=e-a;c<e;c+=1)g.push(this.at(c));return g};a.b.i("Collection.prototype.last",{last:a.l.prototype.last});a.l.prototype.Qp=function(a,b){var c=[],e,g=this;return new Promise(function(h,f){function l(a){return new Promise(function(d,
b){g.XE(a,null).then(function(b){c.push(b);d(a+1)},b)})}var m=Promise.resolve(a);for(e=a;e<b;e++)m=m.then(l);m.then(function(){h(c)},f)})};a.l.prototype.mR=function(d){return void 0===d||null===d?this[a.l.xd]:d};a.l.prototype.R4=function(){var d=this.lastFetchCount;if(void 0===d||null===d)d=this[a.l.xd];return void 0===this.offset||null===this.offset?d:this.offset+d};a.l.prototype.next=function(d,b){b=b||{};b[a.l.xd]=this.mR(d);var c=this.R4(),e=this.Kd();if(0===e&&0<b[a.l.xd])c=0;else if(c>=e)return b.success&&
b.success.call(a.t.li(b,this),this,null,b),null;b.startIndex=c;return this.fetch(b)};a.b.i("Collection.prototype.next",{next:a.l.prototype.next});a.l.prototype.S4=function(a){return void 0===this.offset||null===this.offset?0:this.offset-a};a.l.prototype.Dl=function(d,b){b=b||{};if(0===this.offset)return b.success&&this.lastFetchCount&&b.success.call(a.t.li(b,this),this,null,b),null;b[a.l.xd]=this.mR(d);var c=this.S4(b[a.l.xd]);0>c&&(b[a.l.xd]=this.offset,c=0);b.startIndex=c;return this.fetch(b)};
a.b.i("Collection.prototype.previous",{Dl:a.l.prototype.Dl});a.l.prototype.aL=function(a){this.modelLimit=a;this.Qo(0)};a.b.i("Collection.prototype.setModelLimit",{aL:a.l.prototype.aL});a.l.prototype.KR=function(){return this.modelLimit};a.l.prototype.XB=function(d){this[a.l.xd]=d};a.b.i("Collection.prototype.setFetchSize",{XB:a.l.prototype.XB});a.l.prototype.l_=function(a,b){var c=this.df(b);void 0===a&&(a=1);var e=[];if(this.ab()||c)return this.qg(function(){return this.Qp(a,this.Kd())});for(c=
a;c<this.Kd();c+=1)e.push(this.at(c));return e};a.b.i("Collection.prototype.rest",{l_:a.l.prototype.l_});a.l.prototype.remove=function(d,b){b=b||{};var c=[],e;d instanceof Array?c=d:c.push(d);var g=[];for(e=c.length-1;0<=e;e-=1)g.unshift(this.Rm(c[e],-1,b));this.Pb(b.silent,a.$.F.ALLREMOVED,this,c,b);return a.l.eI(g)};a.b.i("Collection.prototype.remove",{remove:a.l.prototype.remove});a.l.prototype.Rm=function(d,b,c){c=c||{};d=-1==b?this.$g(d):a.l.Mk(b,d);var e=c.silent;b=d.index;if(-1<b){var g=d.m;
void 0!==g&&g.Ps()===this&&g.Zs(null);this.zW(b,1);this.Nj();var h={};a.Ac.Qf(h,c);h.index=b;void 0!==g&&g.Pb(e,a.$.F.REMOVE,g,this,h);this.aX(g)}return d.m};a.l.prototype.aX=function(a){void 0!==a&&a.off(null,null,this)};a.l.prototype.Faa=function(d){d.qk(a.$.F.ALL,this.Zaa,this,!1,!0)};a.l.prototype.Zaa=function(d,b,c,e){d===a.$.F.DESTROY&&this.remove(b);void 0!==c&&c instanceof a.l&&c!==this||(Array.prototype.slice.call(arguments),this.Pb(e&&e.silent,d,b,c,e))};a.l.prototype.refresh=function(d){d=
d||{};var b=this;return this.qg(function(){return new Promise(function(c,e){if(!b.ab()){var g=void 0!==d.silent&&d.silent;try{b.reset(null,{silent:!0});var h={},f;for(f in d)d.hasOwnProperty(f)&&(h[f]=d[f]);h.success=function(d,e,h){b.Pb(g,a.$.F.REFRESH,b,h,null);c({collection:d,response:e,options:h})};h.error=function(c,g,h){e(a.l.Wt(c,g,h,b,d))};b.fetch(h);return}catch(l){if(l instanceof a.Vl){b.Pb(g,a.$.F.REFRESH,b,d,null);c({collection:b,options:d});return}throw l;}}h=d.startIndex;b.ap([],!0);
b.wv();b.totalResults=void 0;b.Nj();g=void 0!==d.silent&&d.silent;b.Pb(g,a.$.F.REFRESH,b,d,null);if(void 0===h||null===h)h=0;void 0!==h&&null!==h?b.bW(h,b.Cj(d)).then(function(a){c(a)}):c(void 0)})})};a.b.i("Collection.prototype.refresh",{refresh:a.l.prototype.refresh});a.l.prototype.reset=function(d,b){var c={};a.Ac.Qf(c,b||{});c.previousModels=this.vc();for(var e,g=0;g<this.Wb.length;g++)if(e=this.Wb[g],e=this.Ib(e))this.aX(e),e.Zs(null);this.ap([],!0);this.wv();g=void 0!==c.silent&&c.silent;if(!d)return this.totalResults=
void 0,this.Nj(),this.Pb(g,a.$.F.RESET,this,c,null),null;e=null;c.parse&&(d=this.parse(d));this.Qo(d instanceof Array?d.length:1);c.SZ=!0;e=this.yk(d,c,!0,!1);this.Nj();this.Pb(g,a.$.F.RESET,this,c,null);return this.Gu(e)};a.b.i("Collection.prototype.reset",{reset:a.l.prototype.reset});a.l.prototype.at=function(a,b){return this.Ak(a,b,!1,this.df(b))};a.b.i("Collection.prototype.at",{at:a.l.prototype.at});a.l.prototype.Ak=function(a,b,c,e){0>a&&(a+=this.Kd());return 0>a||this.tba(a)?null:c||!this.ab()&&
!e?this.Ib(a):this.qg(function(){return this.XE(a,b)})};a.l.prototype.f0=function(){return this.Nm?this.Nm:Promise.resolve()};a.b.i("Collection.prototype.whenReady",{f0:a.l.prototype.f0});a.l.prototype.qg=function(d){var b=this;void 0===this.Nm&&(this.lv=0,this.Nm=Promise.resolve());this.lv++;return this.Nm=this.Nm.then(d.bind(b)).then(function(d){b.lv--;0===b.lv&&(b.Nm=void 0,b.Pb(!1,a.$.F.READY,b,null,null));return d},function(a){b.lv--;0===b.lv&&(b.Nm=void 0);return Promise.reject(a)})};a.l.prototype.XE=
function(d,b){var c=this,e=c.Ib(d);return void 0===e?new Promise(function(e,h){var f={};a.Ac.Qf(f,b||{});f.context=c;f.startIndex=d;f.error=function(d,e,g){h(a.l.Wt(d,e,g,c,b))};f.success=function(){e(c.Ib(d))};c.ee(f,-1,!1)}):new Promise(function(a){a(e)})};a.l.prototype.KJ=function(a){for(var b=this.vc(),c,e=null,g=0;g<this.Wb.length;g++)if(c=this.Wb[g],b[c]&&a===b[c].cid){e=b[c];break}if(e)return e;if(this.ab())throw Error("Not found locally and not supported by server for virtual collections");
return null};a.b.i("Collection.prototype.getByCid",{KJ:a.l.prototype.KJ});a.l.prototype.get=function(a,b){var c=this.$g(a,b,this.df(b));if(c){if(f.isFunction(c.then))return this.qg(function(){return new Promise(function(a,b){c.then(function(b){a(b.m)},function(a){b(a)})})});if(this.ab())return this.qg(function(){return new Promise(function(a){a(c.m)})});if(c.hasOwnProperty("m"))return c.m}return null};a.b.i("Collection.prototype.get",{get:a.l.prototype.get});a.l.prototype.GR=function(a){return(a=
this.IR(a))?a.m:null};a.l.prototype.IR=function(d){var b=d;d instanceof a.t?(b=d.Nn(),d=d.Bf()):a.l.Gk(d)&&void 0!==d.id&&(d=d.id);for(var c=null,e=this.Wb.length,g,h=this.vc(),f,l=0;l<e;l++)if(f=this.Wb[l],g=h[f],void 0!==g&&g.Rn(d,b)){c=a.l.Mk(f,g);break}return c?c:a.l.Mk(-1,void 0)};a.l.prototype.$g=function(d,b,c,e){var g=d;void 0===e&&(e=!1);d instanceof a.t?(g=d.Nn(),d=d.Bf()):a.l.Gk(d)&&void 0!==d.id&&(d=d.id);for(var h=null,f=this.vc(),l,m=0;m<this.Wb.length;m++)if(l=this.Wb[m],f[l]&&f[l].Rn(d,
g)){h=a.l.Mk(l,f[l]);break}if(h)return c?new Promise(function(a){a(h)}):h;if(this.ab()){if(void 0===d&&void 0!==g)return new Promise(function(b){b(a.l.Mk(-1,void 0))});var n=this;return new Promise(function(c,h){var f={};a.Ac.Qf(f,b||{});f.context=n;f.startID=d;f.error=function(d,c,e){h(a.l.Wt(d,c,e,n,b))};f.success=function(b,e){if(null!=e){var h=n.bG(),f=n.Ib(h);void 0!==f&&f.Rn(d,g)?c(a.l.Mk(h,f)):c(a.l.Mk(-1,void 0))}else c(a.l.Mk(-1,void 0))};n.ee(f,-1,e)})}var q=a.l.Mk(-1,void 0);return c?new Promise(function(a){a(q)}):
q};a.l.Mk=function(a,b){return{index:a,m:b}};a.l.prototype.parse=function(a){var b;if(a instanceof Array||!a)return a;for(b in a)if(a.hasOwnProperty(b)&&a[b]instanceof Array)return a[b];return a};a.l.prototype.V4=function(a,b,c){return this.Go()&&0<this.totalResults&&c.start+c.count>=this.totalResults?!0:c.start===a&&c.count===b};a.l.prototype.Rw=function(a,b){var c=this;return this.qg(function(){return c.bW(a,b)})};a.b.i("Collection.prototype.setRangeLocal",{Rw:a.l.prototype.Rw});a.l.prototype.bW=
function(a,b){this.ab()&&this.cI();var c=this.jz(a,b),e=this;if(this.V4(a,b,c))return new Promise(function(a){a(c)});var g=this.KR();-1<g&&g<b&&(this.modelLimit=b);return new Promise(function(c,g){e.aW(a,b,-1,{start:a,count:b},c,g,!0)})};a.l.prototype.aW=function(d,b,c,e,g,h,f){var l=this,m=d+b;this[a.l.xd]&&this[a.l.xd]>b&&(m=this[a.l.xd]+d);var n=null;this.ab()?(n=this.rR(d,m),n>d&&(d=n,m=d+b,this[a.l.xd]&&this[a.l.xd]>b&&(m=this[a.l.xd]+d)),n={context:this,startIndex:d,fetchSize:m-d}):n={context:this};
n.error=function(b,d,c){h(a.l.Wt(b,d,c,l,null))};n.success=function(){var a=l.jz(e.start,e.count);if(f&&l.Go()&&a.count<e.count){var c=a.start+a.count,n=d+b;n<l.totalResults?l.aW(n,b,c,e,g,h,f):g(a)}else g(a)};try{this.ee(n,c,-1<c)}catch(q){q instanceof a.Vl&&(c=l.jz(d,b),g(c))}};a.l.Wt=function(d,b,c,e,g){var h=!1;g&&g.silent&&(h=g.silent);a.t.Ov(e,h,g,b,c,d);g=Error(b);g.xhr=d;g.error=c;g.collection=e;g.status=b;return g};a.l.prototype.p8=function(a,b){var c=this.Mc();return 0===c?a+b:a+b>c?c:a+
b};a.l.prototype.qZ=function(a,b){var c=this.jz(a,b);return 0===this.Mc()?0===b:a===c.start&&(b===c.count||a+b>this.Mc())};a.b.i("Collection.prototype.isRangeLocal",{qZ:a.l.prototype.qZ});a.l.prototype.tu=function(a,b){for(var c=[],e=this.vc(),g=a+b,h=a;h<g;h++)c.push(e[h]);return c};a.l.prototype.jz=function(a,b){if(!this.ab()){if(0<this.Mc()){if(a+b>this.Mc()){var c=this.Mc()-a;return{start:a,count:c,models:this.tu(a,c)}}return{start:a,count:b,models:this.tu(a,b)}}return{start:a,count:0,models:[]}}c=
this.p8(a,b);if(!this.Go()&&c<a+b)return{start:a,count:c-a,models:this.tu(a,c-a)};if(0===c)return{start:a,count:0,models:[]};var e=this.rR(a,c);if(-1<e)return{start:a,count:e-a,models:this.tu(a,e-a)};a>c?b=0:a+b>c&&(b=c-a);return{start:a,count:b,models:this.tu(a,b)}};a.l.prototype.rR=function(a,b){for(var c=a;c<b;c++)if(void 0===this.Ib(c))return c;return-1};a.l.prototype.fetch=function(a){return this.ee(a,-1,!1)};a.b.i("Collection.prototype.fetch",{fetch:a.l.prototype.fetch});a.l.prototype.ee=function(d,
b,c){function e(a,b,d){a.ab()?d||a.cI():b.add||b.sL||a.reset(null,{silent:!0})}var g=d||{},h=g.success,f,l=g.error;g.set&&(g.sL=g.set?!0:!1);void 0===g.parse&&(g.parse=!0);f=this;g.error=function(b,c,e){a.t.Ov(f,!1,d,c,e,b);l&&l.call(a.t.li(d,f),b,c,e)};g.success=function(m){var n;try{n=f.parse(m,d)}catch(l){a.l.sA(f,l,g.error,d);return}f.YV(m,d,n,c);var p=null;if(g.add||f.model){e(f,g,c);try{s=!1,-1===b&&(s=!0,b=f.bG()),p=f.g7(n,b,s,g)}catch(r){a.l.sA(f,r,g.error,d);return}}else if(!c)if(f.ab()){e(f,
g,c);var s=!1;-1===b&&(s=!0,b=f.bG());p=f.Yba(n,b,s)}else g.sL?f.kI(n,!1,g,!1):f.reset(n,{silent:!0});f.ab()&&p&&(f.lastFetchCount=p.length);f.Pb(g.silent?!0:!1,a.$.F.SYNC,f,m,g);h&&h.call(a.t.li(d,f),f,m,g)};return this.GQ(g)};a.l.prototype.Yba=function(a,b,c){var e;if(a){e=a instanceof Array?a:[a];a={};c&&this.Qo(e.length);c=this.ab();for(var g=null,h=0;h<e.length;h+=1)c&&(a={at:b},g=this.Ak(b,null,!0,!1)),a.silent=!0,this.yk(e[h],a,!0,!1),this.Ak(b,null,!0,!1)!==g&&b++}return e};a.l.prototype.g7=
function(d,b,c,e){e=e||{};var g=e.parse,h=a.l.NE(this);if(d){var f=d instanceof Array?d:[d];d={};c&&this.Qo(f.length);c=this.ab();if(e.sL&&!c){for(var l=0;l<f.length;l+=1)b=h&&g?h.parse(f[l]):f[l],f[l]=b;this.kI(f,!1,e,!1)}else{e=null;for(var m=b,l=0;l<f.length;l+=1)b=h&&g?h.parse(f[l]):f[l],c&&(d={at:m},e=this.Ak(m,d,!0,!1)),d.silent=!0,this.yk(b,d,!0,!1),this.Ak(m,null,!0,!1)!==e&&m++}}return f};a.l.sA=function(d,b,c,e){a.u.error(b.toString());c&&c.call(a.t.li(e,d),d,b,e)};a.l.prototype.d7=function(d){var b=
d||{},c=b.success,e,g;void 0===b.parse&&(b.parse=!0);g=this;b.success=function(h){var f,l,m=null,n=[];try{f=g.parse(h,d)}catch(q){a.l.sA(g,q,b.error,d);return}if(b.add||g.model)if(l=a.l.NE(g),f)for(m=f instanceof Array?f:[f],f=0;f<m.length;f+=1){if(l&&b.parse)try{e=l.parse(m[f])}catch(p){a.l.sA(g,p,b.error,d);return}else e=m[f];n.push(g.dv(e))}g.Pb(!1,a.$.F.SYNC,g,h,b);c&&c.call(a.t.li(d,g),g,n,b)};this.GQ(b)};a.l.prototype.GQ=function(d){try{return a.t.Ou("read",this,d)}catch(b){throw a.t.Ov(this,
!1,d,null,b,null),b;}};a.l.prototype.cI=function(){var a=this.totalResults;void 0!==a&&this.Mc()!==a&&(this.ap(Array(a),!0),this.wv(),this.Nj())};a.l.prototype.Cj=function(d){d=d||{};return d[a.l.xd]||this[a.l.xd]};a.l.prototype.ab=function(){return-1<this.Cj(null)};a.l.prototype.qz=function(d,b,c,e,g){d=parseInt(a.l.pz(d,b,c),10);return void 0===d||null===d||isNaN(d)?e?e:g:d};a.l.prototype.YV=function(d,b,c,e){var g={};this.customPagingOptions&&((g=this.customPagingOptions.call(this,d))||(g={}));
b=b||{};this.lastFetchSize=this.qz(g,d,"limit",b.fetchSize,this.fetchSize);this.offset=this.qz(g,d,"offset",b.startIndex,0);this.lastFetchCount=this.qz(g,d,"count",this.lastFetchCount,this.lastFetchCount);this.totalResults=this.qz(g,d,"totalResults",this.totalResults,this.totalResults);this.hasMore=this.a8(a.l.pz(g,d,"hasMore"),this.offset,this.lastFetchSize,this.totalResults);e||(this.totalResults=this.a4(parseInt(a.l.pz(g,d,"totalResults"),10),this.hasMore,this.offset,parseInt(a.l.pz(g,d,"count"),
10),c&&Array.isArray(c)?c.length:0));!this.ab()&&this.totalResults&&this.totalResults!==this.lastFetchCount&&this.lastFetchSize&&this.XB(this.lastFetchSize)};a.l.prototype.a4=function(a,b,c,e,g){return!b&&isNaN(a)?(isNaN(e)?g:e)+c:this.totalResults};a.l.prototype.a8=function(d,b,c,e){return a.l.Gk(d)?d:void 0===e||null===e?!0:b+c>e?!1:!0};a.l.pz=function(a,b,c){return a.hasOwnProperty(c)?a[c]:b?b[c]:void 0};a.l.prototype.bG=function(){return a.l.Gk(this.offset)?this.offset:0};a.l.prototype.create=
function(d,b){function c(b,c){b.save(d instanceof a.t?null:d,c);return b}function e(a,c){if(b.wait){if(g.ab()||h)return g.qg(function(){return Promise.resolve(void 0)})}else return g.add(a,c)}var g=this;b=b||{};var h=this.df(b),f=this.dv(d,b,!1),l=b.success,m=b.context;b.context=this;b.success=function(a,c,d){d.xhr&&(b.xhr=d.xhr);b.wait&&g.add(f,b);l&&l.call(null!=m?m:g,a,c,b)};if(null==f)return!1;b.forceNew=null!=f.Bf();var n=a.t.ty(b);f.Zs(this);if(h||this.ab())return new Promise(function(a){n.merge=
!0;n.deferred=!0;e(f,n).then(function(){b.success=function(c,d,e){e.xhr&&(b.xhr=e.xhr);b.wait?(g.ab()&&(n.force=!0),g.add(f,n).then(function(){l&&l.call(null!=m?m:g,c,d,b);a(c)})):(l&&l.call(null!=m?m:g,c,d,b),a(c))};var d=c(f,b);d||a(d)})});n.merge=!0;e(f,n);return c(f,b)};a.b.i("Collection.prototype.create",{create:a.l.prototype.create});a.l.prototype.a_=function(a){var b=[],c;this.kf("pluck");for(c=0;c<this.Kd();c+=1)b.push(this.at(c).get(a));return b};a.b.i("Collection.prototype.pluck",{a_:a.l.prototype.a_});
a.l.prototype.g0=function(a,b){return this.Gu(this.Uv(a,b))};a.b.i("Collection.prototype.where",{g0:a.l.prototype.g0});a.l.prototype.Uv=function(d,b){b=b||{};var c=this.df(b),e=this;if(this.ab())return new Promise(function(c,g){e.d7({query:d,all:!0,success:function(a,b){c(b)},error:function(c,d,h){g(a.l.Wt(c,d,h,e,b))}})});var g=[],h,f;for(h=0;h<this.Kd();h+=1)f=this.at(h),f.p0(d)&&g.push(f);return c?new Promise(function(a){a(g)}):g};a.l.prototype.h0=function(d,b){b=b||{};var c=this.df(b),e=this;
if(this.ab()||c)return this.qg(function(){return new Promise(function(a,c){return e.Uv(d,b).then(function(b){b=e.VT(b);a(b)},function(a){c(a)})})});c=this.Uv(d,b);c=this.VT(c);c[a.l.xd]=-1;c.Nj();return c};a.b.i("Collection.prototype.whereToCollection",{h0:a.l.prototype.h0});a.l.prototype.VT=function(a){var b=this.qP(!1);b.ap(a,!1);b.wv();b.Nj();return b};a.l.prototype.kf=function(a){if(this.ab())throw Error(a+" not valid on a virtual Collection");};a.l.prototype.map=function(a,b){var c=[],e;this.kf("map");
this.vc().forEach(function(g){e=a.call(b||this,g);c.push(e)});return c};a.b.i("Collection.prototype.map",{map:a.l.prototype.map});a.l.prototype.each=function(a,b){this.kf("each");this.vc().forEach(a,b)};a.b.i("Collection.prototype.each",{each:a.l.prototype.each});a.l.prototype.size=function(){return this.Kd()};a.b.i("Collection.prototype.size",{size:a.l.prototype.size});a.l.prototype.A_=function(d,b){var c=[],e;this.kf("sortBy");this.vc().forEach(function(a){c.push(a)});e=this;c.sort(function(c,h){var k,
l;if(f.isFunction(d))return k=d.call(b||e,c),l=d.call(b||e,h),a.l.Ck(k,l,e.sortDirection);k=c.get(d);l=h.get(d);return a.l.Ck(k,l,e.sortDirection)});return c};a.b.i("Collection.prototype.sortBy",{A_:a.l.prototype.A_});a.l.prototype.XY=function(a,b){var c={},e;this.kf("groupBy");this.vc().forEach(function(g){e=f.isFunction(a)?a.call(b||this,g):g.get(a);void 0===c[e]&&(c[e]=[]);c[e].push(g)},this);return c};a.b.i("Collection.prototype.groupBy",{XY:a.l.prototype.XY});a.l.prototype.hZ=function(a,b){var c=
{},e;this.kf("indexBy");this.vc().forEach(function(g){e=f.isFunction(a)?a.call(b||this,g):g.get(a);c[e]=g},this);return c};a.b.i("Collection.prototype.indexBy",{hZ:a.l.prototype.hZ});a.l.prototype.min=function(a,b){var c={},e,g;this.kf("min");if(0==this.Mc())return null;c=this.Ib(0);e=a.call(b||this,this.Ib(0));this.vc().forEach(function(h,f){1<=f&&(g=a.call(b||this,h),g<e&&(c=h,e=g))},this);return c};a.b.i("Collection.prototype.min",{min:a.l.prototype.min});a.l.prototype.max=function(a,b){var c=
{},e,g;this.kf("max");if(0==this.Mc())return null;c=this.Ib(0);e=a.call(b,this.Ib(0));this.vc().forEach(function(h,f){1<=f&&(g=a.call(b||this,h),g>e&&(c=h,e=g))},this);return c};a.b.i("Collection.prototype.max",{max:a.l.prototype.max});a.l.prototype.filter=function(a,b){var c=[];this.kf("filter");this.vc().forEach(function(e){a.call(b||this,e)&&c.push(e)});return c};a.b.i("Collection.prototype.filter",{filter:a.l.prototype.filter});a.l.prototype.i0=function(a){var b=[],c,e,g,h;this.kf("without");
for(var f,l=0;l<this.vc().length;l++){h=!0;f=this.Ib(l);for(c=0;c<arguments.length;c+=1)if(g=arguments[c].Nn(),e=arguments[c].Bf(),f.Rn(e,g)){h=!1;break}h&&b.push(f)}return b};a.b.i("Collection.prototype.without",{i0:a.l.prototype.i0});a.l.prototype.VX=function(a){var b=[],c,e,g,h,f;this.kf("difference");for(var l,m=0;m<this.vc().length;m++){f=!0;l=this.Ib(m);for(c=0;c<arguments.length;c+=1){for(e=0;e<arguments[c].length;e++)if(h=arguments[c][e].Nn(),g=arguments[c][e].Bf(),l.Rn(g,h)){f=!1;break}if(!f)break}f&&
b.push(l)}return b};a.b.i("Collection.prototype.difference",{VX:a.l.prototype.VX});a.l.prototype.Ig=function(){return 0===this.Kd()};a.b.i("Collection.prototype.isEmpty",{Ig:a.l.prototype.Ig});a.l.prototype.rX=function(a,b){this.kf("any");for(var c,e=0;e<this.Mc();e+=1)if(c=this.Ib(e),a.call(b||this,c))return!0;return!1};a.b.i("Collection.prototype.any",{rX:a.l.prototype.rX});a.l.prototype.aY=function(a,b){var c=this.df(b),e=this;if(this.ab()||c)return this.qg(function(){return new Promise(function(c){e.Uv(a,
b).then(function(a){a&&0<a.length&&c(a[0]);c(null)})})});c=this.Uv(a,b);return 0<c.length?c[0]:null};a.b.i("Collection.prototype.findWhere",{aY:a.l.prototype.aY});a.l.prototype.slice=function(a,b,c){var e=this.df(c);c=[];if(void 0===b){if(this.ab()&&!this.Go())throw Error("End must be set for virtual collections with no totalResults");b=this.Mc()}if(e||this.ab())return this.qg(function(){return this.Qp(a,b)});for(e=a;e<b;e+=1)c.push(this.Ib(e));return c};a.b.i("Collection.prototype.slice",{slice:a.l.prototype.slice});
a.l.prototype.set=function(a,b){return this.kI(a,!0,b,this.df(b)||this.ab())};a.b.i("Collection.prototype.set",{set:a.l.prototype.set});a.l.aV=function(a,b,c,e,g){if(c)for(c=b.length-1;0<=c;c-=1)-1==e.indexOf(c)&&a.Rm(b[c],c,g)};a.l.prototype.Zda=function(a,b,c,e){if(this.yz()||!c||!e)return{index:a,jL:!1};c=this.Mc();if(a>=c||b>=c)return{index:a,jL:!1};c=this.Ib(a);e=this.Ib(b);this.BA(a,e);e.$s(a);this.BA(b,c);c.$s(b);return{index:b,jL:b!==a}};a.l.prototype.kI=function(d,b,c,e){c=c||{};var g=void 0===
c.add?!0:c.add,h=void 0===c.remove?!0:c.remove,k=void 0===c.merge?!0:c.merge,l=[],m=null,n;b&&(d=this.parse(d));n=f.isArray(d)?d:[d];if(e)return this.qg(function(){return this.t6(n,this.vc(),c,h,g,k)});b=!1;for(d=0;d<n.length;d+=1)if(m=this.dX(this.dv(n[d],c,!0),g,k,e),-1!==m){var m=this.Zda(m,d,h,g),q=m.index;m.jL&&(b=!0);-1===l.indexOf(q)&&l.push(q)}b&&this.Pb(c.silent,a.$.F.SORT,this,c.add?{add:!0}:null,null);a.l.aV(this,this.vc(),h,l,c)};a.l.prototype.t6=function(d,b,c,e,g,h){var f=[],l,m=this;
return new Promise(function(n,q){function p(a){return new Promise(function(b,e){m.dX(m.dv(d[a],c,!0),g,h,!0).then(function(c){-1!==c&&f.push(c);b(a+1)},e)})}var r=Promise.resolve(0);for(l=0;l<d.length;l+=1)r=r.then(p);r.then(function(){a.l.aV(m,b,e,f,c);n(void 0)},q)})};a.l.prototype.dX=function(a,b,c,e){function g(e,g,h){var f=g?g.index:-1;if(g&&g.m){if(c){var p={merge:c};if(h)return new Promise(function(b){e.yk(a,p,!1,!0).then(function(){b(f)})});e.add(a,p)}}else if(b){if(h)return new Promise(function(b){e.yk(a,
p,!1,!0).then(function(){b(e.Kd()-1)})});e.add(a);f=e.Kd()-1}return f}if(e||this.ab()){var h=this;return new Promise(function(b){h.$g(a,{silent:!0},e).then(function(a){g(h,a,!0).then(function(a){b(a)})})})}var f=this.$g(a);return g(this,f,!1)};a.l.prototype.toJSON=function(){var a=[];this.kf("toJSON");this.vc().forEach(function(b){a.push(b.toJSON())});return a};a.b.i("Collection.prototype.toJSON",{toJSON:a.l.prototype.toJSON});a.l.prototype.first=function(a,b){var c=this.df(b),e=this.Kd(),g=[];a?
e=a:a=1;c=this.ab()||c;if(1===a)return c?this.XE(0,null):0<this.Mc()?this.Ib(0):null;e>this.Mc()&&(!this.ab()||this.Go())&&(e=this.Mc());if(c)return this.qg(function(){return this.Qp(0,e)});for(c=0;c<e;c+=1)g.push(this.Ib(c));return g};a.b.i("Collection.prototype.first",{first:a.l.prototype.first});a.l.prototype.indexOf=function(a,b){var c=this.df(b);return this.ab()||c?this.$g(a,null,!0).then(function(a){return a.index}):this.$g(a).index};a.b.i("Collection.prototype.indexOf",{indexOf:a.l.prototype.indexOf});
a.l.prototype.contains=function(a,b){var c=this.df(b);return this.ab()||c?this.$g(a,null,!0).then(function(a){return-1<a.index}):-1<this.$g(a).index};a.b.i("Collection.prototype.contains",{contains:a.l.prototype.contains});a.l.prototype.gZ=a.l.prototype.contains;a.b.i("Collection.prototype.include",{gZ:a.l.prototype.gZ});a.l.prototype.Oaa=function(a){a=this.IR(a);return void 0!==a?a.index:-1};a.l.prototype.pop=function(a){var b=this.df(a);if(this.ab()||b){var c=this;return this.at(this.Kd()-1,{deferred:b}).then(function(b){c.remove(b,
a);return b})}b=this.at(this.Kd()-1);this.remove(b,a);return b};a.b.i("Collection.prototype.pop",{pop:a.l.prototype.pop});a.l.prototype.push=function(a,b){var c=this.df(b);this.Qo(1);return this.Gu(this.yk(a,b,!1,c))};a.b.i("Collection.prototype.push",{push:a.l.prototype.push});a.l.prototype.lastIndexOf=function(d,b){var c;this.kf("lastIndexOf");void 0===b&&(b=0);for(c=this.Kd()-1;c>=b;c-=1)if(a.b.Bt(d,this.at(c)))return c;return-1};a.b.i("Collection.prototype.lastIndexOf",{lastIndexOf:a.l.prototype.lastIndexOf});
a.l.prototype.dS=function(a){return void 0===a?[]:a.split(",")};a.l.F8=function(d){d=f.isArray(d)?d:[d];var b="",c,e,g,h;for(g=0;g<d.length;g++){c=d[g];for(h in c)if(c.hasOwnProperty(h))for(var k=f.isArray(c[h])?c[h]:[c[h]],l=0;l<k.length;l++){if(a.t.RL(k[l])){e=k[l].value;var m=null,m=k[l].comparator,m=f.isFunction(m)?m(null,h,e):m;e=h+m+e}else e=h+"\x3d"+c[h];b+=e+"+"}b=b.substring(0,b.length-1)+","}return","===b.substring(b.length-1)?b.substring(0,b.length-1):b};a.l.prototype.P0=function(d){var b=
{},c;for(c in d)d.hasOwnProperty(c)&&(b[c]=d[c]);if((d=this.comparator)&&a.Ba.rd(d)){d=this.dS(d);for(c=0;c<d.length;c++)b.sort=0===c?d[c]:b.sort+(","+d[c]);b.sortDir=this.eS()}this.ab()&&(b[a.l.xd]=this.Cj(b));return b};a.l.prototype.G0=function(){if(f.isFunction(this.customURL))return!0;var d=this.IL(null);return a.l.Gk(d)};a.l.prototype.IL=function(d){var b=a.t.Ol(this,"url");if(this.ab()){var c=d.all,e=null;e=c?(e=this.totalResults)?e:this.Cj(d):this.Cj(d);b=b&&-1<b.indexOf("?")?b+"\x26":b+"?";
b+="limit\x3d"+e;c||(a.l.Gk(d.startIndex)&&(b+="\x26offset\x3d"+d.startIndex),d.startID&&(b+="\x26fromID\x3d"+d.startID),d.since&&(b+="\x26since\x3d"+d.since),d.until&&(b+="\x26until\x3d"+d.until));d.query&&(d=a.l.F8(d.query))&&0<d.length&&(b+="\x26q\x3d"+d);if((d=this.comparator)&&a.Ba.rd(d))for(d=this.dS(d),c=this.eS(),e=0;e<d.length;e++)b=0===e?b+("\x26orderBy\x3d"+d[e]+":"+c):b+(","+d[e]+":"+c);b+="\x26totalResults\x3dtrue"}return b};a.l.prototype.eS=function(){return-1===this.sortDirection?"desc":
"asc"};a.l.prototype.sync=function(a,b,c){return window.oj.sync(a,b,c)};a.l.xd="fetchSize";a.t=function(d,b){a.t._init(this,d,b,null)};o_("Model",a.t,a);a.b.ga(a.t,a.b,"oj.Model");a.t.prototype.Init=function(){a.t.q.Init.call(this)};a.t.prototype.attributes={};a.b.i("Model.prototype.attributes",{attributes:a.t.prototype.attributes});a.t.prototype.ac={};a.b.i("Model.prototype.defaults",{ac:a.t.prototype.ac});a.t.prototype.id=null;a.b.i("Model.prototype.id",{id:a.t.prototype.id});a.t.prototype.eZ="id";
a.b.i("Model.prototype.idAttribute",{eZ:a.t.prototype.eZ});a.t.prototype.c0=null;a.b.i("Model.prototype.urlRoot",{c0:a.t.prototype.c0});a.t.prototype.Wi=null;a.b.i("Model.prototype.customURL",{Wi:a.t.prototype.Wi});a.t.XG=0;a.t._init=function(d,b,c,e){var g=null,h;if(!a.t.Vu){d.Init();a.$.JC(d);d.Bq();d.SK={};d.OB=!1;d.index=-1;c=c||{};d.attributes={};d.defaults&&!c.vga&&(d.attributes=a.t.qy(f.isFunction(d.defaults)?d.defaults():d.defaults,null));for(g in e)e.hasOwnProperty(g)&&(d[g]=e[g]);if(b)if(e=
c.parse,f.isFunction(e)&&(d.parse=e),h=a.t.qy(b,d.attributes),h=e?d.parse(h):h,null==h||void 0===h)d.attributes={};else for(g in h)h.hasOwnProperty(g)&&d.nI(g,h[g],!1,!1,c);d.gx();d.Zs(c.collection);c.customURL&&(d.customURL=c.customURL);c.url&&(d.url=c.url);c.urlRoot&&(d.urlRoot=c.urlRoot);d.initialize&&d.initialize(b,c);d.pj()}};a.t.extend=function(d,b){a.t.Vu=!0;var c,e;c=new a.t;a.t.Vu=!1;f.extend(c,this.prototype);d=d||{};for(e in d)d.hasOwnProperty(e)&&(c[e]=d[e]);var g;g=d&&d.constructor&&
d.hasOwnProperty("constructor")?d.constructor:function(b,c){a.t._init(this,b,c,d)};f.extend(g,this);g.prototype=c;g.extend=a.t.extend;g.prototype.constructor=g;a.$.JC(g,this);if(b)for(e in b)b.hasOwnProperty(e)&&(g[e]=b[e]);return g};o_("Model.extend",a.t.extend,a);a.t.prototype.Pb=function(){};a.t.prototype.gx=function(){this.Nn()||(this.cid="id"+a.t.XG,a.t.XG+=1)};a.t.prototype.Nn=function(){return this.cid};a.t.prototype.$s=function(a){this.index=a};a.t.prototype.B0=function(){return this.index};
a.t.prototype.NC=function(a){this.Sga=a};a.t.prototype.hx=function(a){var b=this.TK;this.TK=a;return b};a.t.prototype.L0=function(d,b,c){var e,g=!1,h=a.Ba.rd(b),f,l=!1;for(e in d.attributes)d.attributes.hasOwnProperty(e)&&(f=this.attributes[e]!=d.attributes[e],h?e===b&&f&&(g=!0):f&&(g=!0),f&&(l=!0,this.attributes[e]=d.attributes[e],this.PD(e,d.attributes[e]),this.Ny(e,this.attributes[e],null,c)));this.pj();l&&this.Oy(null,c);return g};a.t.Iu=function(a){var b;if(a&&a instanceof Object)for(b in a)if(a.hasOwnProperty(b))return!0;
return!1};a.t.prototype.Zs=function(a){null==a?delete this.collection:(this.collection=a,this.pj())};a.t.prototype.Ps=function(){return this.collection};a.t.prototype.Ny=function(d,b,c,e){null!=d&&this.Pb(e,a.$.F.CHANGE+":"+d,this,b,c)};a.t.prototype.Oy=function(d,b){this.Pb(b,a.$.F.CHANGE,this,d,null)};a.t.prototype.pj=function(){var a=null;this.collection&&this.collection.modelId&&(a=this.collection.modelId,a=f.isFunction(a)?a.call(this.collection,this.attributes):a);a||(a=this.RF(),a=null!=this.attributes?
this.attributes[a]:null);this.id=a};a.t.prototype.yda=function(d,b,c){var e=a.b.Bt(this.attributes[d],b);return c||!e?(this.attributes[d]=b,this.pj(),!e):!1};a.t.prototype.Bq=function(){this.changed={}};a.t.prototype.PD=function(a,b){this.changed[a]=b};a.t.prototype.nI=function(d,b,c,e,g){if(null==d)return!0;var h={},f,l=this.OB;if(e)for(f in d)d.hasOwnProperty(f)&&(h[f]=d[f]);else h[d]=b;d=g||{};if(!this.Qt(h,{validate:d.validate},!1))return!1;l||(this.Bq(),this.bn=[]);this.OB||(this.SK=a.t.qy(this.attributes,
null));this.OB=!0;for(f in h)h.hasOwnProperty(f)&&(this.yda(f,h[f],c)?(this.PD(f,h[f]),this.bn.push(f)):delete h[f]);c=d.silent;for(f in h)h.hasOwnProperty(f)&&(!c&&(0<this.bn.length||l&&-1===this.bn.indexOf(f))&&(this.YZ=!0,this.Zga=d),this.Ny(f,h[f],d,c));if(l)return!0;if(!c&&!l)for(;this.YZ;)this.YZ=!1,this.Oy(this.Zga,c);this.OB=!1;return!0};a.t.prototype.clear=function(d){var b,c={silent:!0},e;d=d||{};e=d.silent;c.validate=d.validate;this.Bq();for(b in this.attributes)if(this.attributes.hasOwnProperty(b)){if(!this.TA(b,
c,!0))return!1;this.Pb(e,a.$.F.CHANGE+":"+b,this,void 0,null)}this.attributes={};this.pj();this.Ny(null,null,null,e);this.Oy(null,e);return this};a.b.i("Model.prototype.clear",{clear:a.t.prototype.clear});a.t.qy=function(d,b){b=b||{};for(var c in d)b.hasOwnProperty(c)&&d.hasOwnProperty(c)&&void 0===d[c]&&delete d[c];a.Ac.Qf(b,d,void 0,!0,1E4);return b};a.t.prototype.clone=function(){var d=new this.constructor,b;for(b in this)this.hasOwnProperty(b)&&this[b]!==this.attributes&&(d[b]=this[b]);d.attributes=
a.t.qy(this.attributes,null);delete d.cid;d.gx();d.pj();return d};a.b.i("Model.prototype.clone",{clone:a.t.prototype.clone});a.t.prototype.Rn=function(a,b){var c=this.Bf();if(void 0!==c&&c==a)return!0;c=this.cid;return void 0!==c&&c==b?!0:!1};a.t.prototype.set=function(d,b,c){var e=c||{},g=!1,h,f=!0;if(arguments&&0<arguments.length)if(1<arguments.length&&arguments[arguments.length-1]&&(g=!0,e=arguments[arguments.length-1]||{}),a.t.Iu(d))if(e.unset)for(h in d)d.hasOwnProperty(h)&&this.TA(h,null,!1);
else this.nI(d,null,!0,!0,e)||(f=!1);else for(h=0;h<arguments.length;h+=2)if(void 0!==arguments[h]||h<arguments.length-1||!g&&h===arguments.length-1)e.unset?this.TA(arguments[h],null,!1):this.nI(arguments[h],arguments[h+1],!1,!1,e)||(f=!1);return f?this:!1};a.b.i("Model.prototype.set",{set:a.t.prototype.set});a.t.prototype.a0=function(a,b){return this.TA(a,b,!1)};a.b.i("Model.prototype.unset",{a0:a.t.prototype.a0});a.t.prototype.TA=function(a,b,c){b=b||{};var e=b.silent,g={};if(this.has(a)){if(!this.Qt(g,
b,!1))return!1;c||this.Bq();delete this.attributes[a];this.PD(a,void 0);this.Ny(a,null,null,e);this.Oy(null,e)}this.pj();return!0};a.t.prototype.get=function(a){return this.attributes[a]};a.b.i("Model.prototype.get",{get:a.t.prototype.get});a.t.prototype.has=function(d){return a.l.Gk(this.attributes[d])};a.b.i("Model.prototype.has",{has:a.t.prototype.has});a.t.prototype.fetch=function(d){d=d||{};var b=d.success,c=d.error,e=this,g;g=a.t.ty(d);g.error=function(b,g,f){a.t.Ov(e,!1,d,g,f,b);c&&c.apply(e,
arguments)};g.success=function(c){g.xhr&&(d.xhr=g.xhr);a.t.Qy(e,c,g);f.isFunction(e.parse)&&e.set(e.parse(c),g);b&&b.call(e,this,c,d)};a.t.Ou("read",this,g)};a.b.i("Model.prototype.fetch",{fetch:a.t.prototype.fetch});a.t.prototype.parse=function(a){return a};a.t.prototype.url=function(){var d=this.nS(),b=this.Bf();if(d)return b?d+"/"+encodeURIComponent(b):d;if(d=this.collection)return d=a.t.Ol(d,"url"),b&&d?(b="/"==a.t.i8(d)?"":"/",d+b+encodeURIComponent(this.Bf())):d;throw new a.Vl;};a.b.i("Model.prototype.url",
{url:a.t.prototype.url});a.t.prototype.keys=function(){var a,b=[];for(a in this.attributes)this.attributes.hasOwnProperty(a)&&b.push(a);return b};a.b.i("Model.prototype.keys",{keys:a.t.prototype.keys});a.t.prototype.e0=function(){var a,b=[];for(a in this.attributes)this.attributes.hasOwnProperty(a)&&b.push(this.get(a));return b};a.b.i("Model.prototype.values",{e0:a.t.prototype.e0});a.t.prototype.XZ=function(){var a,b=[],c;for(a in this.attributes)this.attributes.hasOwnProperty(a)&&(c=[],c.push(a),
c.push(this.get(a)),b.push(c));return b};a.b.i("Model.prototype.pairs",{XZ:a.t.prototype.XZ});a.t.prototype.VZ=function(a){var b=[],c,e,g={};if(a instanceof Array)b=a;else for(c=0;c<arguments.length;c++)b.push(arguments[c]);for(e in this.attributes)this.attributes.hasOwnProperty(e)&&-1==b.indexOf(e)&&(g[e]=this.get(e));return g};a.b.i("Model.prototype.omit",{VZ:a.t.prototype.VZ});a.t.prototype.ZZ=function(a){var b=[],c,e={};if(a instanceof Array)b=a;else for(c=0;c<arguments.length;c++)b.push(arguments[c]);
for(c=0;c<b.length;c++)this.attributes.hasOwnProperty(b[c])&&(e[b[c]]=this.get(b[c]));return e};a.b.i("Model.prototype.pick",{ZZ:a.t.prototype.ZZ});a.t.prototype.kZ=function(){var a,b={},c;for(a in this.attributes)this.attributes.hasOwnProperty(a)&&(c=this.get(a),b[c]=a);return b};a.b.i("Model.prototype.invert",{kZ:a.t.prototype.kZ});a.t.i8=function(a){return a.charAt(a.length-1)};a.t.prototype.$ca=function(){var a=this.nS();return a?a:this.Ps()?this.Ps().url:null};a.t.prototype.nS=function(){return a.t.Ol(this,
"urlRoot")};a.t.prototype.parseSave=function(a){return a};a.t.prototype.isValid=function(){var a={};a.validate=this.validate;return this.Qt(this.attributes,a,!1)};a.b.i("Model.prototype.isValid",{isValid:a.t.prototype.isValid});a.t.raa=function(a,b){a=a||{};return void 0!==a.validate&&null!==a.validate?a.validate:b};a.t.prototype.Qt=function(d,b,c){b=b||{};var e=this.validate;return e&&a.t.raa(b,c)&&(this.validationError=e.call(this,d,b))?(this.Pb(!1,a.$.F.INVALID,this,this.validationError,b),!1):
!0};a.t.Mba=function(d){var b=!1,c={},e,g={};if(d&&0<d.length){1<d.length&&d[d.length-1]&&a.t.Iu(d[d.length-1])&&(b=!0,c=d[d.length-1]||{});if(null==d[0])return{attributes:null,options:c};if(a.t.Iu(d[0])||a.b.Ig(d[0]))for(e in d[0])d[0].hasOwnProperty(e)&&(g[e]=d[0][e]);else for(e=0;e<d.length;e+=2)if(void 0!==d[e]||e<d.length-1||!b&&e===d.length-1)g[d[e]]=d[e+1]}return{attributes:g,options:c}};a.t.ty=function(a){var b={},c;a=a||{};for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b};a.t.Ov=function(d,
b,c,e,g,h){c=c||{};c.textStatus=e;c.errorThrown=g;d.Pb(b,a.$.F.ERROR,d,h,c)};a.t.prototype.save=function(d,b){var c,e,g,h,k,l;c=a.t.Mba(arguments);var m,n,q;q=void 0===d?void 0:c.attributes;b=b||{};m=a.t.ty(c.options);if(!this.Qt(this.attributes,m,!0))return!1;m.wait||this.set(q);c=void 0===m.forceNew?!1:m.forceNew;h=this;k=m.error;l=m.patch;m.error=function(c,d,e){a.t.Ov(h,!1,b,d,e,c);k&&k.apply(h,arguments)};m.saveAttrs=m.wait?this.q4(q):this.attributes;n=this.attributes;this.attributes=m.saveAttrs;
m.saveAttrs=this.toJSON();this.attributes=n;if(!c&&!this.EB())return e=m.success,m.success=function(c){var d;m.xhr&&(b.xhr=m.xhr);c&&(d=f.isFunction(h.parse)?h.parse(c):c,h.attributes=f.extend(!0,h.attributes,d),h.pj());a.t.Qy(h,c,m);m.wait&&h.set(q);e&&e.call(a.t.li(m,h),h,c,b);h.Bq()},m.attrs||(m.attrs=void 0===q?void 0:l?q:m.saveAttrs),a.t.Ou(l?"patch":"update",this,m);g=a.t.fS(m);m.success=function(c){var d;m.xhr&&(b.xhr=m.xhr);if(c){d=f.isFunction(h.parse)?h.parse(c):c;if(!h.Qt(d,m,!0))return;
h.attributes=f.extend(!0,h.attributes,d);h.pj()}m.wait&&h.set(q);a.t.Qy(h,c,m);g&&g.call(a.t.li(m,h),h,c,b);h.Bq()};m.attrs||(m.attrs=m.saveAttrs);m.parse=!0;l&&(m.saveAttrs=m.attrs);return a.t.Ou("create",this,m)};a.b.i("Model.prototype.save",{save:a.t.prototype.save});a.t.prototype.q4=function(a){var b={},c;for(c in this.attributes)this.attributes.hasOwnProperty(c)&&(b[c]=this.attributes[c]);for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b};a.t.Ol=function(a,b){return a?f.isFunction(a[b])?a[b]():
a[b]:f.isFunction(b)?b():b};a.t.RL=function(a){return a&&a.hasOwnProperty("value")&&a.hasOwnProperty("comparator")};a.t.prototype.m$=function(d){for(var b in d)if(d.hasOwnProperty(b)){if(!this.attributes.hasOwnProperty(b))return!1;for(var c=f.isArray(d[b])?d[b]:[d[b]],e=0;e<c.length;e++)if(a.t.RL(c[e])){var g=c[e].comparator,h=c[e].value;if(a.Ba.rd(g))throw Error("String comparator invalid for local where/findWhere");if(!g(this,b,h))return!1}else if(d[b]!==this.attributes[b])return!1}return!0};a.t.prototype.matches=
function(a){a:{for(var b in a)if(this.get(b)!==a[b]){a=!1;break a}a=!0}return a};a.b.i("Model.prototype.matches",{matches:a.t.prototype.matches});a.t.prototype.p0=function(a){a=a.constructor===Array?a:[a];var b;for(b=0;b<a.length;b++)if(this.m$(a[b]))return!0;return!1};a.t.fS=function(a){return null!=a&&a.success?a.success:null};a.t.li=function(a,b){return void 0!==a&&void 0!==a.context?a.context:b};a.t.prototype.EB=function(){return void 0==this.Bf()};a.b.i("Model.prototype.isNew",{EB:a.t.prototype.EB});
a.t.prototype.RF=function(){return this.idAttribute||"id"};a.t.prototype.Bf=function(){return this.id};a.t.prototype.pJ=function(d){if(d){var b={},c;for(c in d)d.hasOwnProperty(c)&&(a.b.Bt(d[c],this.attributes[c])||(b[c]=d[c]));return a.b.Ig(b)?!1:b}return a.b.Ig(this.changed)?!1:this.changed};a.b.i("Model.prototype.changedAttributes",{pJ:a.t.prototype.pJ});a.t.prototype.cK=function(d){return void 0!==d?a.t.Iu(this.changed)&&this.changed.hasOwnProperty(d):a.t.Iu(this.changed)};a.b.i("Model.prototype.hasChanged",
{cK:a.t.prototype.cK});a.t.prototype.destroy=function(d){d=d||{};var b=d.wait,c,e=d.error,g=this,h,f;f=a.t.ty(d);c=a.t.fS(f);var l=this.Ps();f.success=function(e){f.xhr&&(d.xhr=f.xhr);b&&g.wF();if(l){var h=a.Ba.rd(e)&&!a.Ba.Ig(e)?JSON.parse(e):e;l.YV(h,null,e,!0)}a.t.Qy(g,e,f);c&&c.call(a.t.li(f,g),g,e,d)};f.error=function(b,c,h){g.Pb(!1,a.$.F.ERROR,g,b,d);e&&e.apply(g,arguments)};if(!this.EB())return h=a.t.Ou("delete",this,f),b||this.wF(),h;b||this.wF();c&&c.call(a.t.li(f,g),g,null,d);return!1};
a.b.i("Model.prototype.destroy",{destroy:a.t.prototype.destroy});a.t.prototype.QQ=function(d,b,c,e){this.Pb(e,a.$.F.REQUEST,d,b,c)};a.t.prototype.wF=function(){this.Pb(!1,a.$.F.DESTROY,this,this.collection,null)};a.t.Qy=function(d,b,c){d.Pb(!1,a.$.F.SYNC,d,b,c)};a.t.prototype.toJSON=function(){var a={},b;for(b in this.attributes)this.attributes.hasOwnProperty(b)&&(f.isArray(this.attributes[b])?a[b]=this.attributes[b].slice(0):a[b]=this.attributes[b]);return a};a.b.i("Model.prototype.toJSON",{toJSON:a.t.prototype.toJSON});
a.t.prototype.Dl=function(a){return this.SK[a]};a.b.i("Model.prototype.previous",{Dl:a.t.prototype.Dl});a.t.prototype.d_=function(){return this.SK};a.b.i("Model.prototype.previousAttributes",{d_:a.t.prototype.d_});a.t.prototype.sync=function(a,b,c){return window.oj.sync(a,b,c)};a.t.Ou=function(d,b,c){c=c||{};b.oauth&&(c.oauthHeader=b.oauth.getHeader());!c.dataType&&b.dataType&&(c.dataType=b.dataType);!c.jsonpCallback&&b.jsonpCallback&&(c.jsonpCallback=b.jsonpCallback);if("create"===d||"patch"===d||
"update"===d)c.PK=b.parseSave.call(b,"patch"===d?c.attrs:c.saveAttrs);var e=null;b instanceof a.t&&(e=b.Bf());var g={};if(c)for(var h in c)g[h]=c[h];e=a.t.gM(e,b,c);for(h in e)g[h]=e[h];c.xhr=b.sync(d,b,g);g.xhr&&(c.xhr=g.xhr);return c.xhr};a.t.gM=function(d,b,c){b=b instanceof a.l?b.P0(c):{};d&&(b.recordID=d);return b};a.kL=function(d,b,c){function e(a){b.QQ(b,a,c,c.silent);return a}c=c||{};var g,h=c.success,f=c.error;g=b.customURL;if("create"===d.valueOf())return d=(d=b.$ca())?d:a.t.Ol(b,"url"),
g=new a.Ua(d,g),e(g.Tea(c.PK,f,c,b));if("read"===d.valueOf()){if(b instanceof a.t)return d=c.url?c.url:a.t.Ol(b,"url"),g=new a.Ua(d,g),e(g.WJ(h,f,b.Bf(),c,a.t.li(c,b)));d=b.IL(c);g=new a.Ua(d,g);return e(g.aga(h,f,c,b))}g=new a.Ua(a.t.Ol(b,"url"),g);var l=null;b instanceof a.t&&(l=b.Bf());return"update"===d.valueOf()?e(g.b0(h,l,c.PK,f,c,b,!1)):"patch"===d.valueOf()?e(g.b0(h,l,c.PK,f,c,b,!0)):"delete"===d.valueOf()?e(g.Gfa(l,f,c,b)):null};o_("sync",a.kL,a);a.t.Iea=function(a){if(!a.url)throw Error("The url property or function must be specified");
};a.ajax=function(){arguments&&0<arguments.length&&a.t.Iea(arguments[0]);return f.ajax.apply(window.oj,arguments)};o_("ajax",a.ajax,a);a.xb=function(d,b){b=b||{};a.xb._init(this,b,d||"Authorization")};o_("OAuth",a.xb,a);a.b.ga(a.xb,a.b,"oj.OAuth");a.xb.prototype.Init=function(){a.xb.q.Init.call(this)};a.xb.prototype.yY=function(){var a={};this.Zm.access_token||this.rJ();a[this.Rj.wX]="Bearer "+this.Zm.access_token;return a};a.b.i("OAuth.prototype.getHeader",{yY:a.xb.prototype.yY});a.xb.prototype.nZ=
function(){return this.Zm.Iia?!0:!1};a.b.i("OAuth.prototype.isInitialized",{nZ:a.xb.prototype.nZ});a.xb.prototype.rJ=function(){var d={},b=this;d[b.Rj.wX]="Basic "+a.xb.w4(b.Rj.client_id+":"+b.Rj.client_secret);f.ajax({type:"POST",async:!1,url:this.Rj.bearer_url,data:"grant_type\x3dclient_credentials",headers:d,success:function(c){a.xb.Nu(b.Zm,c)},error:function(a){throw Error(a.responseText);}})};a.b.i("OAuth.prototype.clientCredentialGrant",{rJ:a.xb.prototype.rJ});a.xb.prototype.r_=function(d){a.xb.Nu(this.Zm,
d)};a.b.i("OAuth.prototype.setAccessTokenResponse",{r_:a.xb.prototype.r_});a.xb.prototype.hY=function(){return this.Zm};a.b.i("OAuth.prototype.getAccessTokenResponse",{hY:a.xb.prototype.hY});a.xb.prototype.EX=function(){a.xb.fP(this.Zm)};a.b.i("OAuth.prototype.cleanAccessTokenResponse",{EX:a.xb.prototype.EX});a.xb.prototype.q_=function(d){a.xb.Nu(this.Rj,d)};a.b.i("OAuth.prototype.setAccessTokenRequest",{q_:a.xb.prototype.q_});a.xb.prototype.gY=function(){return this.Rj};a.b.i("OAuth.prototype.getAccessTokenRequest",
{gY:a.xb.prototype.gY});a.xb.prototype.DX=function(){a.xb.fP(this.Rj)};a.b.i("OAuth.prototype.cleanAccessTokenRequest",{DX:a.xb.prototype.DX});a.xb._init=function(d,b,c){d.Init();d.Rj={};d.Zm={};b.access_token?a.xb.Nu(d.Zm,b):b.client_id&&b.client_secret&&b.bearer_url&&a.xb.Nu(d.Rj,b);d.Rj.wX=c};a.xb.Nu=function(a,b){var c;b=b||{};for(c in b)a[c]=b[c]};a.xb.fP=function(a){for(var b in a)a.hasOwnProperty(b)&&"auth_header"!==b&&(a[b]=null,delete a[b])};a.xb.w4=function(a){var b,c,e,g,h=0,f=0,l=[];do b=
a.charCodeAt(h++),c=a.charCodeAt(h++),e=a.charCodeAt(h++),g=b<<16|c<<8|e,b=g>>18&63,c=g>>12&63,e=g>>6&63,g&=63,l[f++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(b)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(c)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(e)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(g);while(h<a.length);l=l.join("");b=a.length%3;return(b?l.slice(0,
b-3):l)+"\x3d\x3d\x3d".slice(b||3)};a.Ua=function(a,b){this.Pw=a;this.Wi=b;f.support.cors=!0};a.Ua.gq="headers";a.Ua.Xv=function(d,b,c){var e;d=f.extend(!0,d,c);for(e in b)b.hasOwnProperty(e)&&"oauthHeader"!==e&&(d.hasOwnProperty(e)||(d[e]=b[e]),e===a.Ua.gq&&(d[e]=f.extend(!0,d[e],b[e])));if(b.oauthHeader)for(e in d[a.Ua.gq]||(d[a.Ua.gq]={}),b.oauthHeader)b.oauthHeader.hasOwnProperty(e)&&(d[a.Ua.gq].hasOwnProperty(e)||(d[a.Ua.gq][e]=b.oauthHeader[e]));return d};a.Ua.prototype.aga=function(d,b,c,e){c=
c||{};var g="jsonp"===c.dataType,h=this.Eu("read",this.Pw,this.Wi,null,e,c);d={crossDomain:c.crossDomain||!g,dataType:this.cz(c),jsonpCallback:c.jsonpCallback,context:null!==e?e:this,success:d,error:b};d=this.Zx(d);d=a.Ua.Xv(d,c,h);c.xhr=this.ajax(d);return c.xhr};a.Ua.prototype.Zx=function(d){d[a.Ua.gq]={"Accept-Language":this.Wf()};return d};a.Ua.prototype.WJ=function(d,b,c,e,g){e=e||{};var h="jsonp"===e.dataType;c=this.Eu("read",this.Pw,this.Wi,c,g,e);d={crossDomain:e.crossDomain||!h,dataType:this.cz(e),
jsonpCallback:e.jsonpCallback,context:null!==g?g:this,success:d,error:b};d=this.Zx(d);d=a.Ua.Xv(d,e,c);e.xhr=this.ajax(d);return e.xhr};a.Ua.prototype.b0=function(d,b,c,e,g,h,f){g=g||{};var l="jsonp"===g.dataType;b=this.Eu(f?"patch":"update",this.Pw,this.Wi,b,h,g);f=a.Ua.Nq(g);d={crossDomain:g.crossDomain||!l,contentType:this.I7(g),dataType:this.cz(g),jsonpCallback:g.jsonpCallback,data:this.lb(JSON.stringify(c),g,b),emulateHTTP:f,emulateJSON:a.Ua.Oq(g),success:d,error:e,context:null!==h?h:this};d=
this.Zx(d);d=a.Ua.Xv(d,g,b);d=a.Ua.KO(f,d);g.xhr=this.ajax(d);return g.xhr};a.Ua.KO=function(a,b){if(a){var c=b.beforeSend;b.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",b.Qh);if(c)return c.apply(this,arguments)}}return b};a.Ua.prototype.lb=function(d,b,c){return a.Ua.Oq(b)?(b={_method:c.Qh?c.Qh:c.type},d&&(b.model=d),b):d};a.Ua.prototype.Z7=function(d,b){if(b.type)return{method:b.type};var c=null;"create"===d&&(c="POST");"delete"===d&&(c="DELETE");"patch"===d&&(c="PATCH");"update"===
d&&(c="PUT");if(a.Ua.Nq(b)){var e={method:"POST"};e.Qh=c;return e}null===c&&(c="GET");return{method:c}};a.Ua.Nq=function(d){return d.emulateHTTP||a.emulateHTTP};a.Ua.Oq=function(d){return d.emulateJSON||a.emulateJSON};a.Ua.prototype.Eu=function(d,b,c,e,g,h){var k=this.Z7(d,h);if(f.isFunction(c)){d=c.call(this,d,g,a.t.gM(e,g,h));if(a.Ba.rd(d))return b={url:d,type:k.method},k.Qh&&(b.Qh=k.Qh),b;if(d)return d.url=d.hasOwnProperty("url")?d.url:b,d.hasOwnProperty("type")||(d.type=k.method),!d.hasOwnProperty("data")&&
k.Qh&&(d.Qh=k.Qh),d}b={url:a.t.Ol(null,b),type:k.method};k.Qh&&(b.Qh=k.Qh);return b};a.Ua.prototype.Gfa=function(d,b,c,e){c=c||{};var g="jsonp"===c.dataType;d=this.Eu("delete",this.Pw,this.Wi,d,e,c);var h=a.Ua.Nq(c);b={crossDomain:c.crossDomain||!g,success:c.success,error:b,context:null!==e?e:this,emulateHTTP:h,emulateJSON:a.Ua.Oq(c)};(e=this.lb(null,c,d))&&(b.data=e);b=a.Ua.Xv(b,c,d);b=a.Ua.KO(h,b);c.xhr=this.ajax(b);return c.xhr};a.Ua.prototype.Tea=function(d,b,c,e){c=c||{};var g=JSON.stringify(d),
h="jsonp"===c.dataType;d=this.Eu("create",this.Pw,this.Wi,null,e,c);var f=a.Ua.Nq(c);b={crossDomain:c.crossDomain||!h,contentType:c.contentType||"application/json",dataType:this.cz(c),jsonpCallback:c.jsonpCallback,data:this.lb(g,c,d),success:c.success,error:b,emulateHTTP:f,emulateJSON:a.Ua.Oq(c),context:null!==e?e:this};b=this.Zx(b);b=a.Ua.Xv(b,c,d);c.xhr=this.ajax(b);return c.xhr};a.Ua.prototype.cz=function(d){return a.Ua.Oq(d)&&!a.Ua.Nq(d)?"application/x-www-form-urlencoded":d.dataType||"json"};
a.Ua.prototype.I7=function(d){return a.Ua.Oq(d)&&!a.Ua.Nq(d)?"application/x-www-form-urlencoded":d.contentType||"application/json"};a.Ua.prototype.Wf=function(){return a.ba.Wf()};a.Ua.prototype.ajax=function(d){if(null===d.url||void 0===d.url)throw new a.Vl;return window.oj.ajax(d)};a.Vl=function(){this.name="URLError";this.message="No URL defined"};o_("URLError",a.Vl,a);a.Vl.prototype=Error();a.Vl.constructor=a.Vl});